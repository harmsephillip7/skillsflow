# Generated by Django 5.2.8 on 2025-12-03 19:37

import django.db.models.deletion
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('core', '0008_not_task_template'),
        ('corporate', '0006_wbl_models'),
        ('learners', '0001_initial'),
    ]

    operations = [
        migrations.AlterField(
            model_name='role',
            name='code',
            field=models.CharField(choices=[('SUPER_ADMIN', 'Super Administrator'), ('SYSTEM_ADMIN', 'System Administrator'), ('HEAD_OFFICE_MANAGER', 'Head Office Manager'), ('FINANCE_DIRECTOR', 'Finance Director'), ('ACADEMIC_DIRECTOR', 'Academic Director'), ('CORPORATE_DIRECTOR', 'Corporate Services Director'), ('BRAND_MANAGER', 'Brand Manager'), ('BRAND_ACADEMIC_LEAD', 'Brand Academic Lead'), ('BRAND_FINANCE_LEAD', 'Brand Finance Lead'), ('CAMPUS_PRINCIPAL', 'Campus Principal'), ('CAMPUS_ADMIN', 'Campus Administrator'), ('REGISTRAR', 'Registrar'), ('ACADEMIC_COORDINATOR', 'Academic Coordinator'), ('FACILITATOR', 'Facilitator'), ('ASSESSOR', 'Assessor'), ('MODERATOR', 'Moderator'), ('QCTO_INTERNAL_MODERATOR', 'QCTO Internal Moderator'), ('SDF', 'Skills Development Facilitator'), ('SDF_ADMIN', 'SDF Administrator'), ('SALES_MANAGER', 'Sales Manager'), ('SALES_REP', 'Sales Representative'), ('FINANCE_MANAGER', 'Finance Manager'), ('FINANCE_CLERK', 'Finance Clerk'), ('STUDENT', 'Student'), ('CORPORATE_CLIENT_ADMIN', 'Corporate Client Administrator'), ('CORPORATE_CLIENT_HR', 'Corporate Client HR Manager'), ('CORPORATE_CLIENT_SDF', 'Corporate Client SDF'), ('CORPORATE_EMPLOYEE', 'Corporate Employee'), ('WORKPLACE_OFFICER', 'Workplace Officer'), ('MENTOR', 'Workplace Mentor'), ('HOST_EMPLOYER_ADMIN', 'Host Employer Administrator'), ('LEAD_EMPLOYER_ADMIN', 'Lead Employer Administrator')], max_length=30, unique=True),
        ),
        migrations.CreateModel(
            name='MessageThread',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_deleted', models.BooleanField(default=False)),
                ('deleted_at', models.DateTimeField(blank=True, null=True)),
                ('subject', models.CharField(max_length=200)),
                ('thread_type', models.CharField(choices=[('GENERAL', 'General'), ('PLACEMENT', 'Placement Related'), ('SUPPORT', 'Support/Advice'), ('DISCIPLINARY', 'Disciplinary'), ('ACADEMIC', 'Academic')], default='GENERAL', max_length=20)),
                ('is_archived', models.BooleanField(default=False)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('deleted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_deleted', to=settings.AUTH_USER_MODEL)),
                ('related_learner', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='message_threads', to='learners.learner')),
                ('related_placement', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='message_threads', to='corporate.workplaceplacement')),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Message Thread',
                'verbose_name_plural': 'Message Threads',
                'ordering': ['-updated_at'],
            },
        ),
        migrations.CreateModel(
            name='Message',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('content', models.TextField()),
                ('sent_at', models.DateTimeField(auto_now_add=True)),
                ('is_system_message', models.BooleanField(default=False)),
                ('edited_at', models.DateTimeField(blank=True, null=True)),
                ('is_deleted', models.BooleanField(default=False)),
                ('read_by', models.JSONField(blank=True, default=dict)),
                ('sender', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='thread_messages_sent', to=settings.AUTH_USER_MODEL)),
                ('thread', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='messages', to='core.messagethread')),
            ],
            options={
                'verbose_name': 'Message',
                'verbose_name_plural': 'Messages',
                'ordering': ['sent_at'],
            },
        ),
        migrations.CreateModel(
            name='WorkplaceOfficerProfile',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_deleted', models.BooleanField(default=False)),
                ('deleted_at', models.DateTimeField(blank=True, null=True)),
                ('employee_number', models.CharField(blank=True, max_length=50)),
                ('phone', models.CharField(blank=True, max_length=20)),
                ('assigned_region', models.CharField(blank=True, max_length=100)),
                ('max_placements', models.PositiveIntegerField(default=30, help_text='Maximum number of placements this officer can manage')),
                ('qualifications', models.TextField(blank=True)),
                ('is_active', models.BooleanField(default=True)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('deleted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_deleted', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
                ('user', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='workplace_officer_profile', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Workplace Officer Profile',
                'verbose_name_plural': 'Workplace Officer Profiles',
            },
        ),
        migrations.CreateModel(
            name='ManagedDocument',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_deleted', models.BooleanField(default=False)),
                ('deleted_at', models.DateTimeField(blank=True, null=True)),
                ('title', models.CharField(max_length=200)),
                ('document_type', models.CharField(choices=[('ID_COPY', 'ID Copy'), ('QUALIFICATION', 'Qualification Certificate'), ('AGREEMENT', 'Agreement/Contract'), ('LOGBOOK_SCAN', 'Logbook Scan'), ('ATTENDANCE_REGISTER', 'Attendance Register'), ('LEAVE_DOCUMENT', 'Leave Supporting Document'), ('WM_EVIDENCE', 'Workplace Module Evidence'), ('DISCIPLINARY_NOTICE', 'Disciplinary Notice'), ('DISCIPLINARY_RESPONSE', 'Disciplinary Response'), ('HEARING_MINUTES', 'Hearing Minutes'), ('PLACEMENT_LETTER', 'Placement Letter'), ('VISIT_REPORT', 'Visit Report'), ('REPORT', 'Report'), ('CORRESPONDENCE', 'Correspondence'), ('OTHER', 'Other')], default='OTHER', max_length=30)),
                ('description', models.TextField(blank=True)),
                ('storage_backend', models.CharField(choices=[('LOCAL', 'Local Storage'), ('SHAREPOINT', 'SharePoint')], default='LOCAL', max_length=20)),
                ('local_file', models.FileField(blank=True, null=True, upload_to='managed_documents/%Y/%m/')),
                ('sharepoint_id', models.CharField(blank=True, max_length=255)),
                ('sharepoint_site_id', models.CharField(blank=True, max_length=255)),
                ('sharepoint_drive_id', models.CharField(blank=True, max_length=255)),
                ('sharepoint_item_id', models.CharField(blank=True, max_length=255)),
                ('sharepoint_web_url', models.URLField(blank=True, max_length=500)),
                ('sharepoint_folder_path', models.CharField(blank=True, max_length=500)),
                ('original_filename', models.CharField(max_length=255)),
                ('file_size', models.PositiveIntegerField(default=0)),
                ('mime_type', models.CharField(blank=True, max_length=100)),
                ('file_hash', models.CharField(blank=True, max_length=64)),
                ('thumbnail_cache', models.ImageField(blank=True, null=True, upload_to='document_thumbnails/')),
                ('preview_cached_at', models.DateTimeField(blank=True, null=True)),
                ('metadata', models.JSONField(blank=True, default=dict)),
                ('tags', models.JSONField(blank=True, default=list)),
                ('version', models.PositiveIntegerField(default=1)),
                ('is_confidential', models.BooleanField(default=False)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('deleted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_deleted', to=settings.AUTH_USER_MODEL)),
                ('replaces', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='replaced_by', to='core.manageddocument')),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Managed Document',
                'verbose_name_plural': 'Managed Documents',
                'ordering': ['-created_at'],
                'indexes': [models.Index(fields=['document_type'], name='core_manage_documen_fc80e4_idx'), models.Index(fields=['storage_backend'], name='core_manage_storage_9dafea_idx')],
            },
        ),
        migrations.CreateModel(
            name='Notification',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('notification_type', models.CharField(choices=[('LOGBOOK_UNSIGNED', 'Logbook Requires Signature'), ('LOGBOOK_SIGNED', 'Logbook Signed'), ('ATTENDANCE_REMINDER', 'Attendance Submission Reminder'), ('ATTENDANCE_VERIFIED', 'Attendance Verified'), ('DISCIPLINARY_ACTION', 'Disciplinary Action'), ('DISCIPLINARY_REVIEW_DUE', 'Disciplinary Review Due'), ('STIPEND_CALCULATED', 'Stipend Calculated'), ('STIPEND_APPROVED', 'Stipend Approved'), ('PLACEMENT_VISIT_SCHEDULED', 'Placement Visit Scheduled'), ('PLACEMENT_STATUS_CHANGE', 'Placement Status Changed'), ('NEW_MESSAGE', 'New Message'), ('WM_COMPLETED', 'Workplace Module Completed'), ('WM_SIGNED', 'Workplace Module Signed Off'), ('SYSTEM', 'System Notification'), ('REMINDER', 'Reminder')], default='SYSTEM', max_length=30)),
                ('priority', models.CharField(choices=[('LOW', 'Low'), ('NORMAL', 'Normal'), ('HIGH', 'High'), ('URGENT', 'Urgent')], default='NORMAL', max_length=10)),
                ('title', models.CharField(max_length=200)),
                ('message', models.TextField()),
                ('link', models.CharField(blank=True, max_length=500)),
                ('is_read', models.BooleanField(default=False)),
                ('read_at', models.DateTimeField(blank=True, null=True)),
                ('email_sent', models.BooleanField(default=False)),
                ('email_sent_at', models.DateTimeField(blank=True, null=True)),
                ('sms_sent', models.BooleanField(default=False)),
                ('sms_sent_at', models.DateTimeField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='system_notifications', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Notification',
                'verbose_name_plural': 'Notifications',
                'ordering': ['-created_at'],
                'indexes': [models.Index(fields=['user', 'is_read'], name='core_notifi_user_id_cb8f07_idx'), models.Index(fields=['user', 'notification_type'], name='core_notifi_user_id_aa1102_idx')],
            },
        ),
        migrations.CreateModel(
            name='NotificationPreference',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('notification_type', models.CharField(choices=[('LOGBOOK_UNSIGNED', 'Logbook Requires Signature'), ('LOGBOOK_SIGNED', 'Logbook Signed'), ('ATTENDANCE_REMINDER', 'Attendance Submission Reminder'), ('ATTENDANCE_VERIFIED', 'Attendance Verified'), ('DISCIPLINARY_ACTION', 'Disciplinary Action'), ('DISCIPLINARY_REVIEW_DUE', 'Disciplinary Review Due'), ('STIPEND_CALCULATED', 'Stipend Calculated'), ('STIPEND_APPROVED', 'Stipend Approved'), ('PLACEMENT_VISIT_SCHEDULED', 'Placement Visit Scheduled'), ('PLACEMENT_STATUS_CHANGE', 'Placement Status Changed'), ('NEW_MESSAGE', 'New Message'), ('WM_COMPLETED', 'Workplace Module Completed'), ('WM_SIGNED', 'Workplace Module Signed Off'), ('SYSTEM', 'System Notification'), ('REMINDER', 'Reminder')], max_length=30)),
                ('in_app_enabled', models.BooleanField(default=True)),
                ('email_enabled', models.BooleanField(default=True)),
                ('sms_enabled', models.BooleanField(default=False)),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='system_notification_preferences', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Notification Preference',
                'verbose_name_plural': 'Notification Preferences',
                'unique_together': {('user', 'notification_type')},
            },
        ),
        migrations.CreateModel(
            name='ThreadParticipant',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('role_label', models.CharField(blank=True, choices=[('LEARNER', 'Learner'), ('MENTOR', 'Mentor'), ('FACILITATOR', 'Facilitator'), ('WORKPLACE_OFFICER', 'Workplace Officer'), ('HOST_EMPLOYER', 'Host Employer'), ('ADMIN', 'Administrator')], max_length=20)),
                ('last_read_at', models.DateTimeField(blank=True, null=True)),
                ('is_muted', models.BooleanField(default=False)),
                ('joined_at', models.DateTimeField(auto_now_add=True)),
                ('left_at', models.DateTimeField(blank=True, null=True)),
                ('is_active', models.BooleanField(default=True)),
                ('thread', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='participants', to='core.messagethread')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='thread_participations', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Thread Participant',
                'verbose_name_plural': 'Thread Participants',
                'unique_together': {('thread', 'user')},
            },
        ),
    ]

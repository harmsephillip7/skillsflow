# Generated by Django 5.2.8 on 2026-01-26 13:05

import django.db.models.deletion
import uuid
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('academics', '0014_add_phase_type_choices'),
        ('crm', '0002_lead_consent_bulk_messaging_lead_consent_date_and_more'),
        ('intakes', '0003_contract_and_learner_tracking'),
        ('integrations', '0019_alter_integrationconnection_api_key_and_more'),
        ('learners', '0014_dailylogbookentry_attendance_record'),
        ('tenants', '0002_extend_campus_code_length'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.AlterField(
            model_name='leadactivity',
            name='activity_type',
            field=models.CharField(choices=[('CALL', 'Phone Call'), ('EMAIL', 'Email'), ('WHATSAPP', 'WhatsApp'), ('SMS', 'SMS'), ('MEETING', 'Meeting'), ('NOTE', 'Note'), ('STATUS_CHANGE', 'Status Change'), ('ASSIGNMENT', 'Assignment'), ('FOLLOW_UP', 'Follow-up Scheduled'), ('DOCUMENT', 'Document')], max_length=20),
        ),
        migrations.CreateModel(
            name='Application',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_deleted', models.BooleanField(default=False)),
                ('deleted_at', models.DateTimeField(blank=True, null=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('status', models.CharField(choices=[('DRAFT', 'Draft'), ('SUBMITTED', 'Submitted'), ('DOCUMENTS_PENDING', 'Documents Pending'), ('UNDER_REVIEW', 'Under Review'), ('ACCEPTED', 'Accepted'), ('WAITLIST', 'Waitlist'), ('REJECTED', 'Rejected'), ('ENROLLED', 'Enrolled'), ('WITHDRAWN', 'Withdrawn')], default='DRAFT', max_length=20)),
                ('submitted_at', models.DateTimeField(blank=True, null=True)),
                ('reviewed_at', models.DateTimeField(blank=True, null=True)),
                ('decision_notes', models.TextField(blank=True)),
                ('required_documents', models.JSONField(default=list, help_text='List of required document types')),
                ('missing_documents', models.JSONField(default=list, help_text='List of missing document types')),
                ('parent_consent_required', models.BooleanField(default=False)),
                ('parent_consent_received', models.BooleanField(default=False)),
                ('parent_consent_date', models.DateField(blank=True, null=True)),
                ('enrollment_date', models.DateField(blank=True, null=True)),
                ('last_communication_at', models.DateTimeField(blank=True, null=True)),
                ('next_follow_up', models.DateTimeField(blank=True, null=True)),
                ('campus', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_items', to='tenants.campus')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('deleted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_deleted', to=settings.AUTH_USER_MODEL)),
                ('enrollment', models.OneToOneField(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='application', to='academics.enrollment')),
                ('learner', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='applications', to='learners.learner')),
                ('parent_consent_document', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='consent_applications', to='learners.document')),
                ('reviewed_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='reviewed_applications', to=settings.AUTH_USER_MODEL)),
                ('submitted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='submitted_applications', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Application',
                'verbose_name_plural': 'Applications',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='ApplicationDocument',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_deleted', models.BooleanField(default=False)),
                ('deleted_at', models.DateTimeField(blank=True, null=True)),
                ('document_type', models.CharField(help_text="e.g., 'ID', 'Matric Certificate'", max_length=50)),
                ('is_verified', models.BooleanField(default=False)),
                ('verified_at', models.DateTimeField(blank=True, null=True)),
                ('verification_notes', models.TextField(blank=True)),
                ('application', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='documents', to='crm.application')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('deleted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_deleted', to=settings.AUTH_USER_MODEL)),
                ('document', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='application_documents', to='learners.document')),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
                ('verified_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='verified_app_documents', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Application Document',
                'verbose_name_plural': 'Application Documents',
                'ordering': ['document_type'],
            },
        ),
        migrations.CreateModel(
            name='Campaign',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_deleted', models.BooleanField(default=False)),
                ('deleted_at', models.DateTimeField(blank=True, null=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('name', models.CharField(max_length=200)),
                ('description', models.TextField(blank=True)),
                ('campaign_type', models.CharField(choices=[('BULK', 'Bulk Send'), ('DRIP', 'Drip Campaign'), ('TRIGGERED', 'Triggered')], default='BULK', max_length=20)),
                ('status', models.CharField(choices=[('DRAFT', 'Draft'), ('PENDING_APPROVAL', 'Pending Approval'), ('APPROVED', 'Approved'), ('SCHEDULED', 'Scheduled'), ('SENDING', 'Sending'), ('PAUSED', 'Paused'), ('COMPLETED', 'Completed'), ('CANCELLED', 'Cancelled')], default='DRAFT', max_length=20)),
                ('channel_type', models.CharField(choices=[('WHATSAPP', 'WhatsApp'), ('FACEBOOK', 'Facebook Messenger'), ('INSTAGRAM', 'Instagram DM'), ('TIKTOK', 'TikTok'), ('EMAIL', 'Email'), ('SMS', 'SMS')], max_length=20)),
                ('audience_filter', models.JSONField(default=dict, help_text='Filter criteria: {lead_type, age_range, status, source, tags}')),
                ('scheduled_at', models.DateTimeField(blank=True, null=True)),
                ('started_at', models.DateTimeField(blank=True, null=True)),
                ('completed_at', models.DateTimeField(blank=True, null=True)),
                ('total_recipients', models.PositiveIntegerField(default=0)),
                ('sent_count', models.PositiveIntegerField(default=0)),
                ('delivered_count', models.PositiveIntegerField(default=0)),
                ('read_count', models.PositiveIntegerField(default=0)),
                ('failed_count', models.PositiveIntegerField(default=0)),
                ('opted_out_count', models.PositiveIntegerField(default=0)),
                ('replied_count', models.PositiveIntegerField(default=0)),
                ('estimated_cost', models.DecimalField(decimal_places=2, default=0, max_digits=10)),
                ('actual_cost', models.DecimalField(decimal_places=2, default=0, max_digits=10)),
                ('campus', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_items', to='tenants.campus')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('deleted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_deleted', to=settings.AUTH_USER_MODEL)),
                ('target_campuses', models.ManyToManyField(blank=True, help_text='Empty = all campuses in brand', related_name='campaigns', to='tenants.campus')),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Campaign',
                'verbose_name_plural': 'Campaigns',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='CampaignApproval',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_deleted', models.BooleanField(default=False)),
                ('deleted_at', models.DateTimeField(blank=True, null=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('requested_at', models.DateTimeField(auto_now_add=True)),
                ('request_notes', models.TextField(blank=True)),
                ('status', models.CharField(choices=[('PENDING', 'Pending'), ('APPROVED', 'Approved'), ('REJECTED', 'Rejected'), ('CHANGES_REQUESTED', 'Changes Requested')], default='PENDING', max_length=20)),
                ('decision_at', models.DateTimeField(blank=True, null=True)),
                ('comments', models.TextField(blank=True)),
                ('version', models.PositiveIntegerField(default=1)),
                ('campaign_snapshot', models.JSONField(default=dict, help_text='Snapshot of campaign config at time of approval request')),
                ('approver', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='campaign_approvals', to=settings.AUTH_USER_MODEL)),
                ('campaign', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='approvals', to='crm.campaign')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('deleted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_deleted', to=settings.AUTH_USER_MODEL)),
                ('requested_by', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='campaign_approval_requests', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Campaign Approval',
                'verbose_name_plural': 'Campaign Approvals',
                'ordering': ['-requested_at'],
            },
        ),
        migrations.CreateModel(
            name='ConversationTag',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_deleted', models.BooleanField(default=False)),
                ('deleted_at', models.DateTimeField(blank=True, null=True)),
                ('name', models.CharField(max_length=50)),
                ('color', models.CharField(default='#6B7280', max_length=7)),
                ('description', models.TextField(blank=True)),
                ('campus', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_items', to='tenants.campus')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('deleted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_deleted', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Conversation Tag',
                'verbose_name_plural': 'Conversation Tags',
                'ordering': ['campus', 'name'],
                'unique_together': {('campus', 'name')},
            },
        ),
        migrations.CreateModel(
            name='EmailAccount',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_deleted', models.BooleanField(default=False)),
                ('deleted_at', models.DateTimeField(blank=True, null=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('email_address', models.EmailField(max_length=254, unique=True)),
                ('display_name', models.CharField(max_length=100)),
                ('status', models.CharField(choices=[('ACTIVE', 'Active'), ('INACTIVE', 'Inactive'), ('PENDING', 'Pending OAuth'), ('ERROR', 'Error'), ('EXPIRED', 'Token Expired')], default='PENDING', max_length=20)),
                ('status_message', models.TextField(blank=True)),
                ('last_sync_at', models.DateTimeField(blank=True, null=True)),
                ('access_token', models.TextField(blank=True)),
                ('refresh_token', models.TextField(blank=True)),
                ('token_expires_at', models.DateTimeField(blank=True, null=True)),
                ('signature_html', models.TextField(blank=True, help_text='HTML email signature')),
                ('auto_reply_enabled', models.BooleanField(default=False)),
                ('auto_reply_message', models.TextField(blank=True)),
                ('sync_enabled', models.BooleanField(default=True)),
                ('sync_inbox', models.BooleanField(default=True)),
                ('sync_sent', models.BooleanField(default=True)),
                ('last_delta_token', models.TextField(blank=True, help_text='Microsoft Graph delta token')),
                ('agent', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='email_accounts', to=settings.AUTH_USER_MODEL)),
                ('campus', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_items', to='tenants.campus')),
                ('connection', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='email_accounts', to='integrations.integrationconnection')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('deleted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_deleted', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Email Account',
                'verbose_name_plural': 'Email Accounts',
                'ordering': ['campus', 'email_address'],
            },
        ),
        migrations.CreateModel(
            name='Conversation',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_deleted', models.BooleanField(default=False)),
                ('deleted_at', models.DateTimeField(blank=True, null=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('channel_type', models.CharField(choices=[('WHATSAPP', 'WhatsApp'), ('FACEBOOK', 'Facebook Messenger'), ('INSTAGRAM', 'Instagram DM'), ('TIKTOK', 'TikTok'), ('EMAIL', 'Email'), ('SMS', 'SMS')], max_length=20)),
                ('contact_identifier', models.CharField(help_text='Phone number (WA/SMS), email, or platform user ID', max_length=200)),
                ('contact_name', models.CharField(blank=True, max_length=200)),
                ('contact_profile_pic', models.URLField(blank=True)),
                ('external_id', models.CharField(blank=True, help_text="Platform's conversation ID", max_length=200)),
                ('email_thread_id', models.CharField(blank=True, max_length=200)),
                ('email_subject', models.CharField(blank=True, max_length=500)),
                ('status', models.CharField(choices=[('OPEN', 'Open'), ('PENDING', 'Pending Response'), ('SNOOZED', 'Snoozed'), ('CLOSED', 'Closed')], default='OPEN', max_length=20)),
                ('priority', models.CharField(choices=[('LOW', 'Low'), ('NORMAL', 'Normal'), ('HIGH', 'High'), ('URGENT', 'Urgent')], default='NORMAL', max_length=20)),
                ('snoozed_until', models.DateTimeField(blank=True, null=True)),
                ('last_message_at', models.DateTimeField(blank=True, null=True)),
                ('last_inbound_at', models.DateTimeField(blank=True, null=True)),
                ('last_outbound_at', models.DateTimeField(blank=True, null=True)),
                ('first_response_at', models.DateTimeField(blank=True, null=True)),
                ('response_time_seconds', models.PositiveIntegerField(blank=True, null=True)),
                ('whatsapp_window_expires_at', models.DateTimeField(blank=True, null=True)),
                ('requires_template', models.BooleanField(default=False, help_text='True if 24hr window expired and template message required')),
                ('message_count', models.PositiveIntegerField(default=0)),
                ('unread_count', models.PositiveIntegerField(default=0)),
                ('assigned_agent', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='assigned_conversations', to=settings.AUTH_USER_MODEL)),
                ('campus', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_items', to='tenants.campus')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('deleted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_deleted', to=settings.AUTH_USER_MODEL)),
                ('lead', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='conversations', to='crm.lead')),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
                ('tags', models.ManyToManyField(blank=True, related_name='conversations', to='crm.conversationtag')),
                ('email_account', models.ForeignKey(blank=True, help_text='For email conversations', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='conversations', to='crm.emailaccount')),
            ],
            options={
                'verbose_name': 'Conversation',
                'verbose_name_plural': 'Conversations',
                'ordering': ['-last_message_at'],
            },
        ),
        migrations.CreateModel(
            name='MessageTemplate',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_deleted', models.BooleanField(default=False)),
                ('deleted_at', models.DateTimeField(blank=True, null=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('name', models.CharField(max_length=100)),
                ('slug', models.SlugField(max_length=100)),
                ('description', models.TextField(blank=True)),
                ('channel_type', models.CharField(choices=[('WHATSAPP', 'WhatsApp'), ('EMAIL', 'Email'), ('SMS', 'SMS')], max_length=20)),
                ('category', models.CharField(choices=[('MARKETING', 'Marketing'), ('UTILITY', 'Utility'), ('AUTHENTICATION', 'Authentication')], default='UTILITY', max_length=20)),
                ('header_type', models.CharField(choices=[('NONE', 'No Header'), ('TEXT', 'Text'), ('IMAGE', 'Image'), ('VIDEO', 'Video'), ('DOCUMENT', 'Document')], default='NONE', max_length=20)),
                ('header_content', models.TextField(blank=True, help_text='Header text or media URL')),
                ('body', models.TextField(help_text='Message body with {{variable}} placeholders')),
                ('footer', models.CharField(blank=True, help_text='Footer text (WhatsApp)', max_length=60)),
                ('variables', models.JSONField(default=list, help_text="List of variable names: ['first_name', 'course_name']")),
                ('buttons', models.JSONField(blank=True, default=list, help_text='Button configuration for interactive templates')),
                ('email_subject', models.CharField(blank=True, max_length=200)),
                ('email_html_template', models.TextField(blank=True)),
                ('whatsapp_template_id', models.CharField(blank=True, max_length=100)),
                ('whatsapp_template_name', models.CharField(blank=True, max_length=100)),
                ('status', models.CharField(choices=[('DRAFT', 'Draft'), ('PENDING', 'Pending Approval'), ('APPROVED', 'Approved'), ('REJECTED', 'Rejected')], default='DRAFT', max_length=20)),
                ('rejection_reason', models.TextField(blank=True)),
                ('approved_at', models.DateTimeField(blank=True, null=True)),
                ('times_used', models.PositiveIntegerField(default=0)),
                ('last_used_at', models.DateTimeField(blank=True, null=True)),
                ('campus', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_items', to='tenants.campus')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('deleted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_deleted', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Message Template',
                'verbose_name_plural': 'Message Templates',
                'ordering': ['campus', 'channel_type', 'name'],
                'unique_together': {('campus', 'channel_type', 'slug')},
            },
        ),
        migrations.CreateModel(
            name='Message',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_deleted', models.BooleanField(default=False)),
                ('deleted_at', models.DateTimeField(blank=True, null=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('external_id', models.CharField(blank=True, help_text="Platform's message ID", max_length=200)),
                ('direction', models.CharField(choices=[('IN', 'Inbound'), ('OUT', 'Outbound')], max_length=3)),
                ('message_type', models.CharField(choices=[('TEXT', 'Text'), ('IMAGE', 'Image'), ('VIDEO', 'Video'), ('AUDIO', 'Audio'), ('DOCUMENT', 'Document'), ('STICKER', 'Sticker'), ('LOCATION', 'Location'), ('CONTACT', 'Contact'), ('TEMPLATE', 'Template'), ('INTERACTIVE', 'Interactive'), ('REACTION', 'Reaction'), ('EMAIL', 'Email')], default='TEXT', max_length=20)),
                ('content', models.JSONField(default=dict, help_text='Message content: {text, media_url, caption, template_name, etc.}')),
                ('text_content', models.TextField(blank=True, help_text='Plain text version for search')),
                ('template_variables', models.JSONField(blank=True, default=dict)),
                ('email_subject', models.CharField(blank=True, max_length=500)),
                ('email_html', models.TextField(blank=True)),
                ('email_attachments', models.JSONField(blank=True, default=list)),
                ('status', models.CharField(choices=[('PENDING', 'Pending'), ('QUEUED', 'Queued'), ('SENT', 'Sent'), ('DELIVERED', 'Delivered'), ('READ', 'Read'), ('FAILED', 'Failed'), ('DELETED', 'Deleted')], default='PENDING', max_length=20)),
                ('status_updated_at', models.DateTimeField(blank=True, null=True)),
                ('error_message', models.TextField(blank=True)),
                ('error_code', models.CharField(blank=True, max_length=50)),
                ('sent_at', models.DateTimeField(blank=True, null=True)),
                ('delivered_at', models.DateTimeField(blank=True, null=True)),
                ('read_at', models.DateTimeField(blank=True, null=True)),
                ('metadata', models.JSONField(blank=True, default=dict, help_text='Platform-specific metadata')),
                ('campaign', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='messages', to='crm.campaign')),
                ('conversation', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='messages', to='crm.conversation')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('deleted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_deleted', to=settings.AUTH_USER_MODEL)),
                ('sent_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='crm_sent_messages', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
                ('template', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='messages', to='crm.messagetemplate')),
            ],
            options={
                'verbose_name': 'Message',
                'verbose_name_plural': 'Messages',
                'ordering': ['created_at'],
            },
        ),
        migrations.AddField(
            model_name='campaign',
            name='template',
            field=models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='campaigns', to='crm.messagetemplate'),
        ),
        migrations.CreateModel(
            name='AutomationRule',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_deleted', models.BooleanField(default=False)),
                ('deleted_at', models.DateTimeField(blank=True, null=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('name', models.CharField(max_length=100)),
                ('description', models.TextField(blank=True)),
                ('trigger_event', models.CharField(choices=[('LEAD_CREATED', 'Lead Created'), ('LEAD_STATUS_CHANGE', 'Lead Status Changed'), ('OPPORTUNITY_CREATED', 'Opportunity Created'), ('OPPORTUNITY_STAGE_CHANGE', 'Opportunity Stage Changed'), ('BIRTHDAY', 'Birthday'), ('AGE_MILESTONE', 'Age Milestone (e.g., turns 18)'), ('MATRIC_RESULTS', 'Matric Results Released'), ('INACTIVITY', 'Inactivity Period'), ('MESSAGE_RECEIVED', 'Message Received'), ('FORM_SUBMITTED', 'Form Submitted')], max_length=30)),
                ('trigger_conditions', models.JSONField(default=dict, help_text="Conditions that must be met: {field: value, operator: 'eq'|'gt'|'lt'|'contains'}")),
                ('action_type', models.CharField(choices=[('SEND_MESSAGE', 'Send Message'), ('SEND_EMAIL', 'Send Email'), ('SEND_SMS', 'Send SMS'), ('CREATE_TASK', 'Create Task'), ('ASSIGN_AGENT', 'Assign to Agent'), ('UPDATE_LEAD_STATUS', 'Update Lead Status'), ('UPDATE_OPPORTUNITY_STAGE', 'Update Opportunity Stage'), ('ADD_TAG', 'Add Tag'), ('NOTIFY_AGENT', 'Notify Agent'), ('WEBHOOK', 'Trigger Webhook')], max_length=30)),
                ('action_config', models.JSONField(default=dict, help_text='Action configuration: {template_id, channel_id, delay_minutes, etc.}')),
                ('delay_minutes', models.PositiveIntegerField(default=0, help_text='Wait time before executing action')),
                ('is_active', models.BooleanField(default=True)),
                ('times_triggered', models.PositiveIntegerField(default=0)),
                ('times_executed', models.PositiveIntegerField(default=0)),
                ('last_triggered_at', models.DateTimeField(blank=True, null=True)),
                ('campus', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_items', to='tenants.campus')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('deleted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_deleted', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
                ('template', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='automation_rules', to='crm.messagetemplate')),
            ],
            options={
                'verbose_name': 'Automation Rule',
                'verbose_name_plural': 'Automation Rules',
                'ordering': ['campus', 'trigger_event', 'name'],
            },
        ),
        migrations.CreateModel(
            name='Opportunity',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_deleted', models.BooleanField(default=False)),
                ('deleted_at', models.DateTimeField(blank=True, null=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('name', models.CharField(help_text="e.g., 'Michael Smith - Electrical Engineering N4'", max_length=200)),
                ('stage', models.CharField(choices=[('DISCOVERY', 'Discovery'), ('QUALIFICATION', 'Qualification'), ('PROPOSAL', 'Proposal'), ('NEGOTIATION', 'Negotiation'), ('COMMITTED', 'Committed'), ('WON', 'Won'), ('LOST', 'Lost')], default='DISCOVERY', max_length=20)),
                ('stage_entered_at', models.DateTimeField(auto_now_add=True)),
                ('value', models.DecimalField(decimal_places=2, default=0, help_text='Expected revenue from this enrollment', max_digits=12)),
                ('probability', models.PositiveIntegerField(default=10, help_text='Likelihood of closing (0-100%)')),
                ('expected_close_date', models.DateField(blank=True, null=True)),
                ('expected_start_date', models.DateField(blank=True, help_text='When they expect to start studying', null=True)),
                ('funding_type', models.CharField(choices=[('SELF', 'Self-Funded'), ('EMPLOYER', 'Employer-Funded'), ('BURSARY', 'Bursary'), ('SETA', 'SETA Learnership'), ('NSFAS', 'NSFAS'), ('LOAN', 'Student Loan'), ('SCHOLARSHIP', 'Scholarship'), ('MIXED', 'Mixed Funding')], default='SELF', max_length=20)),
                ('funding_confirmed', models.BooleanField(default=False)),
                ('funding_amount', models.DecimalField(decimal_places=2, default=0, max_digits=12)),
                ('funding_notes', models.TextField(blank=True)),
                ('lost_reason', models.CharField(blank=True, choices=[('PRICE', 'Too Expensive'), ('TIMING', 'Wrong Timing'), ('COMPETITOR', 'Chose Competitor'), ('UNQUALIFIED', 'Not Qualified'), ('NO_RESPONSE', 'No Response'), ('PERSONAL', 'Personal Reasons'), ('LOCATION', 'Location Issue'), ('OTHER', 'Other')], max_length=20)),
                ('lost_to_competitor', models.CharField(blank=True, max_length=100)),
                ('lost_notes', models.TextField(blank=True)),
                ('lost_at', models.DateTimeField(blank=True, null=True)),
                ('reopen_date', models.DateField(blank=True, help_text='When to re-engage this opportunity (e.g., when minor turns 18)', null=True)),
                ('notes', models.TextField(blank=True)),
                ('assigned_agent', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='assigned_opportunities', to=settings.AUTH_USER_MODEL)),
                ('campus', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_items', to='tenants.campus')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('deleted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_deleted', to=settings.AUTH_USER_MODEL)),
                ('funding_application', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='opportunities', to='crm.fundingapplication')),
                ('intake', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='opportunities', to='intakes.intake')),
                ('lead', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='opportunities', to='crm.lead')),
                ('qualification', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='opportunities', to='academics.qualification')),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Opportunity',
                'verbose_name_plural': 'Opportunities',
                'ordering': ['-created_at'],
            },
        ),
        migrations.AddField(
            model_name='conversation',
            name='opportunity',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='conversations', to='crm.opportunity'),
        ),
        migrations.CreateModel(
            name='AutomationExecution',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('trigger_data', models.JSONField(default=dict)),
                ('triggered_at', models.DateTimeField(auto_now_add=True)),
                ('scheduled_for', models.DateTimeField(blank=True, null=True)),
                ('executed_at', models.DateTimeField(blank=True, null=True)),
                ('status', models.CharField(choices=[('PENDING', 'Pending'), ('SCHEDULED', 'Scheduled'), ('EXECUTING', 'Executing'), ('COMPLETED', 'Completed'), ('FAILED', 'Failed'), ('SKIPPED', 'Skipped')], default='PENDING', max_length=20)),
                ('result', models.JSONField(default=dict)),
                ('error_message', models.TextField(blank=True)),
                ('lead', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='automation_executions', to='crm.lead')),
                ('rule', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='executions', to='crm.automationrule')),
                ('opportunity', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='automation_executions', to='crm.opportunity')),
            ],
            options={
                'verbose_name': 'Automation Execution',
                'verbose_name_plural': 'Automation Executions',
                'ordering': ['-triggered_at'],
            },
        ),
        migrations.AddField(
            model_name='application',
            name='opportunity',
            field=models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='application', to='crm.opportunity'),
        ),
        migrations.CreateModel(
            name='OpportunityActivity',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_deleted', models.BooleanField(default=False)),
                ('deleted_at', models.DateTimeField(blank=True, null=True)),
                ('activity_type', models.CharField(choices=[('STAGE_CHANGE', 'Stage Change'), ('CALL', 'Phone Call'), ('EMAIL', 'Email'), ('MEETING', 'Meeting'), ('NOTE', 'Note'), ('QUOTE_SENT', 'Quote Sent'), ('DOCUMENT', 'Document'), ('FOLLOW_UP', 'Follow-up Scheduled')], max_length=20)),
                ('description', models.TextField()),
                ('from_stage', models.CharField(blank=True, max_length=20)),
                ('to_stage', models.CharField(blank=True, max_length=20)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('deleted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_deleted', to=settings.AUTH_USER_MODEL)),
                ('opportunity', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='activities', to='crm.opportunity')),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Opportunity Activity',
                'verbose_name_plural': 'Opportunity Activities',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='SMSConfig',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_deleted', models.BooleanField(default=False)),
                ('deleted_at', models.DateTimeField(blank=True, null=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('provider', models.CharField(choices=[('BULKSMS', 'BulkSMS'), ('CLICKATELL', 'Clickatell'), ('TWILIO', 'Twilio'), ('AFRICA_TALKING', "Africa's Talking")], max_length=20)),
                ('api_key', models.CharField(max_length=200)),
                ('api_secret', models.CharField(blank=True, max_length=200)),
                ('account_id', models.CharField(blank=True, max_length=100)),
                ('sender_id', models.CharField(help_text='Alphanumeric sender ID (max 11 chars)', max_length=11)),
                ('status', models.CharField(choices=[('ACTIVE', 'Active'), ('INACTIVE', 'Inactive'), ('ERROR', 'Error')], default='ACTIVE', max_length=20)),
                ('status_message', models.TextField(blank=True)),
                ('monthly_limit', models.PositiveIntegerField(default=10000)),
                ('messages_sent_this_month', models.PositiveIntegerField(default=0)),
                ('limit_reset_at', models.DateTimeField(blank=True, null=True)),
                ('cost_per_sms', models.DecimalField(decimal_places=4, default=0.0, max_digits=6)),
                ('balance', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True)),
                ('campus', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_items', to='tenants.campus')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('deleted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_deleted', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'SMS Configuration',
                'verbose_name_plural': 'SMS Configurations',
                'ordering': ['campus', 'provider'],
            },
        ),
        migrations.AddField(
            model_name='conversation',
            name='sms_config',
            field=models.ForeignKey(blank=True, help_text='For SMS conversations', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='conversations', to='crm.smsconfig'),
        ),
        migrations.AddField(
            model_name='campaign',
            name='sms_config',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='campaigns', to='crm.smsconfig'),
        ),
        migrations.CreateModel(
            name='SocialChannel',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_deleted', models.BooleanField(default=False)),
                ('deleted_at', models.DateTimeField(blank=True, null=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('channel_type', models.CharField(choices=[('WHATSAPP', 'WhatsApp Business'), ('FACEBOOK', 'Facebook Messenger'), ('INSTAGRAM', 'Instagram DM'), ('TIKTOK', 'TikTok')], max_length=20)),
                ('external_id', models.CharField(help_text='Phone number ID (WhatsApp), Page ID (FB), IG ID, or TikTok ID', max_length=100)),
                ('display_name', models.CharField(help_text="e.g., 'JHB Campus WhatsApp'", max_length=100)),
                ('display_number', models.CharField(blank=True, help_text='Display phone number for WhatsApp', max_length=20)),
                ('purpose', models.CharField(choices=[('SALES', 'Sales'), ('MARKETING', 'Marketing'), ('SUPPORT', 'Support'), ('GENERAL', 'General')], default='SALES', max_length=20)),
                ('status', models.CharField(choices=[('ACTIVE', 'Active'), ('INACTIVE', 'Inactive'), ('PENDING', 'Pending Setup'), ('ERROR', 'Error')], default='PENDING', max_length=20)),
                ('status_message', models.TextField(blank=True)),
                ('last_health_check', models.DateTimeField(blank=True, null=True)),
                ('webhook_verify_token', models.CharField(blank=True, max_length=100)),
                ('whatsapp_business_account_id', models.CharField(blank=True, max_length=50)),
                ('daily_message_limit', models.PositiveIntegerField(default=1000)),
                ('messages_sent_today', models.PositiveIntegerField(default=0)),
                ('limit_reset_at', models.DateTimeField(blank=True, null=True)),
                ('assigned_agents', models.ManyToManyField(blank=True, help_text='Agents who can receive conversations from this channel', related_name='assigned_channels', to=settings.AUTH_USER_MODEL)),
                ('campus', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_items', to='tenants.campus')),
                ('connection', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='social_channels', to='integrations.integrationconnection')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('deleted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_deleted', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Social Channel',
                'verbose_name_plural': 'Social Channels',
                'ordering': ['campus', 'channel_type'],
            },
        ),
        migrations.AddField(
            model_name='conversation',
            name='social_channel',
            field=models.ForeignKey(blank=True, help_text='For social media channels', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='conversations', to='crm.socialchannel'),
        ),
        migrations.AddField(
            model_name='campaign',
            name='social_channel',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='campaigns', to='crm.socialchannel'),
        ),
        migrations.AddField(
            model_name='automationrule',
            name='social_channel',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='automation_rules', to='crm.socialchannel'),
        ),
        migrations.CreateModel(
            name='CampaignRecipient',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('status', models.CharField(choices=[('PENDING', 'Pending'), ('QUEUED', 'Queued'), ('SENT', 'Sent'), ('DELIVERED', 'Delivered'), ('READ', 'Read'), ('FAILED', 'Failed'), ('OPTED_OUT', 'Opted Out'), ('REPLIED', 'Replied')], default='PENDING', max_length=20)),
                ('queued_at', models.DateTimeField(blank=True, null=True)),
                ('sent_at', models.DateTimeField(blank=True, null=True)),
                ('delivered_at', models.DateTimeField(blank=True, null=True)),
                ('read_at', models.DateTimeField(blank=True, null=True)),
                ('replied_at', models.DateTimeField(blank=True, null=True)),
                ('error_message', models.TextField(blank=True)),
                ('retry_count', models.PositiveIntegerField(default=0)),
                ('rendered_content', models.TextField(blank=True)),
                ('campaign', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='recipients', to='crm.campaign')),
                ('lead', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='campaign_recipients', to='crm.lead')),
                ('conversation', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='campaign_recipients', to='crm.conversation')),
                ('message', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='campaign_recipient', to='crm.message')),
            ],
            options={
                'verbose_name': 'Campaign Recipient',
                'verbose_name_plural': 'Campaign Recipients',
                'ordering': ['campaign', 'status'],
                'indexes': [models.Index(fields=['campaign', 'status'], name='crm_campaig_campaig_213252_idx')],
                'unique_together': {('campaign', 'lead')},
            },
        ),
        migrations.AddIndex(
            model_name='message',
            index=models.Index(fields=['conversation', 'created_at'], name='crm_message_convers_81e780_idx'),
        ),
        migrations.AddIndex(
            model_name='message',
            index=models.Index(fields=['external_id'], name='crm_message_externa_1c06c6_idx'),
        ),
        migrations.AddIndex(
            model_name='message',
            index=models.Index(fields=['status'], name='crm_message_status_9d7ce9_idx'),
        ),
        migrations.AddIndex(
            model_name='opportunity',
            index=models.Index(fields=['stage', 'campus'], name='crm_opportu_stage_646456_idx'),
        ),
        migrations.AddIndex(
            model_name='opportunity',
            index=models.Index(fields=['assigned_agent', 'stage'], name='crm_opportu_assigne_905ff8_idx'),
        ),
        migrations.AddIndex(
            model_name='opportunity',
            index=models.Index(fields=['expected_close_date'], name='crm_opportu_expecte_b650f1_idx'),
        ),
        migrations.AddIndex(
            model_name='automationexecution',
            index=models.Index(fields=['rule', 'status'], name='crm_automat_rule_id_7f63d7_idx'),
        ),
        migrations.AddIndex(
            model_name='automationexecution',
            index=models.Index(fields=['scheduled_for', 'status'], name='crm_automat_schedul_9438b0_idx'),
        ),
        migrations.AddIndex(
            model_name='application',
            index=models.Index(fields=['status', 'campus'], name='crm_applica_status_d4d9d2_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='socialchannel',
            unique_together={('channel_type', 'external_id')},
        ),
        migrations.AddIndex(
            model_name='conversation',
            index=models.Index(fields=['channel_type', 'contact_identifier'], name='crm_convers_channel_45d897_idx'),
        ),
        migrations.AddIndex(
            model_name='conversation',
            index=models.Index(fields=['assigned_agent', 'status'], name='crm_convers_assigne_7b456d_idx'),
        ),
        migrations.AddIndex(
            model_name='conversation',
            index=models.Index(fields=['lead'], name='crm_convers_lead_id_40dbcf_idx'),
        ),
        migrations.AddIndex(
            model_name='conversation',
            index=models.Index(fields=['last_message_at'], name='crm_convers_last_me_a2d988_idx'),
        ),
    ]

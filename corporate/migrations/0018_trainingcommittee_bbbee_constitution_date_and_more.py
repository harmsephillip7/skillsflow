# Generated by Django 5.2.8 on 2026-01-09 08:27

import django.core.validators
import django.db.models.deletion
from decimal import Decimal
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('corporate', '0017_meetingtemplate_meeting_purpose_and_more'),
        ('tenants', '0002_extend_campus_code_length'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.AddField(
            model_name='trainingcommittee',
            name='bbbee_constitution_date',
            field=models.DateField(blank=True, help_text='Date B-BBEE transformation committee was constituted (if separate)', null=True),
        ),
        migrations.AddField(
            model_name='trainingcommittee',
            name='bbbee_constitution_document',
            field=models.FileField(blank=True, null=True, upload_to='training_committees/bbbee_constitutions/'),
        ),
        migrations.AddField(
            model_name='trainingcommittee',
            name='is_bbbee_committee',
            field=models.BooleanField(default=False, help_text='Committee handles B-BBEE transformation matters'),
        ),
        migrations.AlterField(
            model_name='trainingcommittee',
            name='committee_function',
            field=models.CharField(choices=[('TRAINING_ONLY', 'Training Committee Only'), ('EE_ONLY', 'EE Committee Only'), ('BBBEE_ONLY', 'B-BBEE Transformation Committee Only'), ('COMBINED', 'Combined Training & EE Committee'), ('TRAINING_BBBEE', 'Combined Training & B-BBEE Committee'), ('EE_BBBEE', 'Combined EE & B-BBEE Committee'), ('ALL', 'All Committees (Training, EE & B-BBEE)')], default='TRAINING_ONLY', help_text='Whether this committee handles Training, EE, B-BBEE, or combinations thereof', max_length=20),
        ),
        migrations.CreateModel(
            name='BBBEEServiceYear',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_deleted', models.BooleanField(default=False)),
                ('deleted_at', models.DateTimeField(blank=True, null=True)),
                ('financial_year', models.PositiveIntegerField(help_text='Financial year ending (e.g., 2025 for FY ending Feb 2025)')),
                ('year_end_month', models.PositiveIntegerField(default=2, help_text='Month in which financial year ends (1-12)', validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(12)])),
                ('enterprise_type', models.CharField(choices=[('EME', 'Exempted Micro Enterprise (â‰¤R10m)'), ('QSE', 'Qualifying Small Enterprise (R10-50m)'), ('GENERIC', 'Generic Enterprise (>R50m)')], default='GENERIC', help_text='Classification based on annual turnover', max_length=10)),
                ('annual_turnover', models.DecimalField(blank=True, decimal_places=2, help_text='Annual turnover used for classification', max_digits=14, null=True)),
                ('black_ownership_percentage', models.DecimalField(blank=True, decimal_places=2, help_text='Total black ownership % (for EME/QSE auto-recognition)', max_digits=5, null=True)),
                ('black_women_ownership_percentage', models.DecimalField(blank=True, decimal_places=2, help_text='Black women ownership % (for bonus level)', max_digits=5, null=True)),
                ('status', models.CharField(choices=[('NOT_STARTED', 'Not Started'), ('DATA_COLLECTION', 'Data Collection'), ('OWNERSHIP_ANALYSIS', 'Ownership Analysis'), ('MANAGEMENT_ANALYSIS', 'Management Control Analysis'), ('SKILLS_DEV_ANALYSIS', 'Skills Development Analysis'), ('ESD_ANALYSIS', 'Enterprise/Supplier Development Analysis'), ('SED_ANALYSIS', 'Socio-Economic Development Analysis'), ('INTERNAL_REVIEW', 'Internal Review'), ('CLIENT_REVIEW', 'Client Review'), ('VERIFICATION_SCHEDULED', 'Verification Scheduled'), ('VERIFICATION_IN_PROGRESS', 'Verification In Progress'), ('VERIFIED', 'Verified'), ('CERTIFICATE_ISSUED', 'Certificate Issued'), ('COMPLETED', 'Completed')], default='NOT_STARTED', max_length=30)),
                ('outcome', models.CharField(choices=[('PENDING', 'Pending Verification'), ('LEVEL_1', 'Level 1'), ('LEVEL_2', 'Level 2'), ('LEVEL_3', 'Level 3'), ('LEVEL_4', 'Level 4'), ('LEVEL_5', 'Level 5'), ('LEVEL_6', 'Level 6'), ('LEVEL_7', 'Level 7'), ('LEVEL_8', 'Level 8'), ('NON_COMPLIANT', 'Non-Compliant'), ('NOT_VERIFIED', 'Not Verified')], default='PENDING', max_length=20)),
                ('target_verification_date', models.DateField(blank=True, help_text='Target date for verification', null=True)),
                ('actual_verification_date', models.DateField(blank=True, null=True)),
                ('certificate_issue_date', models.DateField(blank=True, null=True)),
                ('certificate_expiry_date', models.DateField(blank=True, null=True)),
                ('verification_agency', models.CharField(blank=True, max_length=200)),
                ('verification_agency_contact', models.CharField(blank=True, max_length=200)),
                ('verification_agency_email', models.EmailField(blank=True, max_length=254)),
                ('verification_agency_phone', models.CharField(blank=True, max_length=20)),
                ('certificate_number', models.CharField(blank=True, max_length=100)),
                ('progress_percentage', models.PositiveIntegerField(default=0, validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(100)])),
                ('notes', models.TextField(blank=True)),
                ('assigned_consultant', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='assigned_bbbee_years', to=settings.AUTH_USER_MODEL)),
                ('campus', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_items', to='tenants.campus')),
                ('client', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='bbbee_service_years', to='corporate.corporateclient')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('deleted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_deleted', to=settings.AUTH_USER_MODEL)),
                ('ee_service_year', models.ForeignKey(blank=True, help_text='EE data for Management Control element', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='bbbee_service_years', to='corporate.eeserviceyear')),
                ('employee_snapshot', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='bbbee_service_years', to='corporate.clientemployeesnapshot')),
                ('scorecard', models.OneToOneField(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='service_year', to='corporate.bbbeescorecard')),
                ('subscription', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='bbbee_service_years', to='corporate.clientservicesubscription')),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
                ('wspatr_service_year', models.ForeignKey(blank=True, help_text='WSP/ATR data for Skills Development element', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='bbbee_service_years', to='corporate.wspatrserviceyear')),
            ],
            options={
                'verbose_name': 'B-BBEE Service Year',
                'verbose_name_plural': 'B-BBEE Service Years',
                'ordering': ['-financial_year'],
                'unique_together': {('subscription', 'financial_year')},
            },
        ),
        migrations.CreateModel(
            name='BBBEEDocument',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_deleted', models.BooleanField(default=False)),
                ('deleted_at', models.DateTimeField(blank=True, null=True)),
                ('document_type', models.CharField(choices=[('CIPC_REGISTRATION', 'CIPC Company Registration'), ('SHARE_CERTIFICATES', 'Share Certificates'), ('SHAREHOLDERS_AGREEMENT', 'Shareholders Agreement'), ('DIRECTORS_RESOLUTION', 'Directors Resolution'), ('ANNUAL_FINANCIAL_STATEMENTS', 'Annual Financial Statements'), ('MANAGEMENT_ACCOUNTS', 'Management Accounts'), ('TAX_CLEARANCE', 'Tax Clearance Certificate'), ('ORGANOGRAM', 'Company Organogram'), ('OWNERSHIP_PROOF', 'Ownership Proof Documentation'), ('BOARD_COMPOSITION', 'Board Composition Documentation'), ('EXEC_DEMOGRAPHICS', 'Executive Demographics'), ('PAYROLL_SUMMARY', 'Payroll Summary (Management Control)'), ('SKILLS_DEV_SPEND', 'Skills Development Spend Evidence'), ('LEARNERSHIPS_PROOF', 'Learnerships/Internships Proof'), ('ESD_CONTRIBUTIONS', 'Enterprise/Supplier Development Evidence'), ('SED_CONTRIBUTIONS', 'Socio-Economic Development Evidence'), ('PREFERENTIAL_PROCUREMENT', 'Preferential Procurement Records'), ('SUPPLIER_DECLARATIONS', 'Supplier B-BBEE Declarations'), ('VERIFICATION_REPORT', 'Verification Agency Report'), ('BBBEE_CERTIFICATE', 'B-BBEE Certificate'), ('SWORN_AFFIDAVIT', 'Sworn Affidavit (EME/QSE)'), ('TRANSFORMATION_PLAN', 'Transformation Strategy/Plan'), ('OTHER', 'Other Document')], max_length=30)),
                ('name', models.CharField(blank=True, help_text='Custom name if needed', max_length=200)),
                ('description', models.TextField(blank=True)),
                ('file', models.FileField(blank=True, null=True, upload_to='bbbee_documents/%Y/%m/')),
                ('file_name', models.CharField(blank=True, max_length=255)),
                ('file_size', models.PositiveIntegerField(blank=True, null=True)),
                ('status', models.CharField(choices=[('PENDING', 'Pending Upload'), ('UPLOADED', 'Uploaded'), ('UNDER_REVIEW', 'Under Review'), ('APPROVED', 'Approved/Verified'), ('REJECTED', 'Rejected - Reupload Required'), ('NOT_APPLICABLE', 'Not Applicable')], default='PENDING', max_length=20)),
                ('is_required', models.BooleanField(default=True)),
                ('uploaded_at', models.DateTimeField(blank=True, null=True)),
                ('notes', models.TextField(blank=True)),
                ('campus', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_items', to='tenants.campus')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('deleted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_deleted', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
                ('uploaded_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='uploaded_bbbee_documents', to=settings.AUTH_USER_MODEL)),
                ('service_year', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='documents', to='corporate.bbbeeserviceyear')),
            ],
            options={
                'verbose_name': 'B-BBEE Document',
                'verbose_name_plural': 'B-BBEE Documents',
                'ordering': ['document_type'],
            },
        ),
        migrations.CreateModel(
            name='ESDElement',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_deleted', models.BooleanField(default=False)),
                ('deleted_at', models.DateTimeField(blank=True, null=True)),
                ('total_procurement_spend', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Total measured procurement spend', max_digits=14)),
                ('bbbee_procurement_spend', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Spend with B-BBEE compliant suppliers', max_digits=14)),
                ('qse_eme_spend', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Spend with QSE/EME suppliers', max_digits=14)),
                ('black_owned_spend', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Spend with 51%+ black-owned suppliers', max_digits=14)),
                ('black_women_owned_spend', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Spend with 30%+ black women-owned suppliers', max_digits=14)),
                ('designated_group_spend', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Spend with suppliers owned by designated groups (youth, disabled, rural)', max_digits=14)),
                ('npat', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Net Profit After Tax', max_digits=14)),
                ('supplier_dev_spend', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Annual spend on supplier development', max_digits=14)),
                ('supplier_dev_beneficiaries', models.PositiveIntegerField(default=0, help_text='Number of supplier development beneficiaries')),
                ('enterprise_dev_spend', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Annual spend on enterprise development', max_digits=14)),
                ('enterprise_dev_beneficiaries', models.PositiveIntegerField(default=0, help_text='Number of enterprise development beneficiaries')),
                ('graduated_emes', models.PositiveIntegerField(default=0, help_text='EMEs graduated to QSE status')),
                ('graduated_qses', models.PositiveIntegerField(default=0, help_text='QSEs graduated to Generic status')),
                ('preferential_procurement_score', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=5)),
                ('supplier_development_score', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=5)),
                ('enterprise_development_score', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=5)),
                ('calculated_score', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Combined ESD score (out of 40 for Generic)', max_digits=5)),
                ('notes', models.TextField(blank=True)),
                ('campus', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_items', to='tenants.campus')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('deleted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_deleted', to=settings.AUTH_USER_MODEL)),
                ('service_year', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='esd_element', to='corporate.bbbeeserviceyear')),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'ESD Element',
                'verbose_name_plural': 'ESD Elements',
            },
        ),
        migrations.CreateModel(
            name='ESDSupplier',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_deleted', models.BooleanField(default=False)),
                ('deleted_at', models.DateTimeField(blank=True, null=True)),
                ('supplier_type', models.CharField(choices=[('PREFERENTIAL', 'Preferential Procurement Supplier'), ('SUPPLIER_DEV', 'Supplier Development Beneficiary'), ('ENTERPRISE_DEV', 'Enterprise Development Beneficiary')], max_length=20)),
                ('supplier_name', models.CharField(max_length=200)),
                ('registration_number', models.CharField(blank=True, max_length=50)),
                ('contact_person', models.CharField(blank=True, max_length=200)),
                ('email', models.EmailField(blank=True, max_length=254)),
                ('phone', models.CharField(blank=True, max_length=20)),
                ('bbbee_level', models.PositiveIntegerField(blank=True, help_text='Supplier B-BBEE level', null=True)),
                ('is_eme', models.BooleanField(default=False)),
                ('is_qse', models.BooleanField(default=False)),
                ('black_ownership_percentage', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('black_women_ownership_percentage', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('annual_spend', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Annual procurement spend with this supplier', max_digits=14)),
                ('development_contribution', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='ED/SD contribution value', max_digits=14)),
                ('support_type', models.CharField(blank=True, help_text='Type of ED/SD support provided', max_length=200)),
                ('support_start_date', models.DateField(blank=True, null=True)),
                ('support_end_date', models.DateField(blank=True, null=True)),
                ('bbbee_certificate', models.FileField(blank=True, null=True, upload_to='bbbee_supplier_certificates/')),
                ('notes', models.TextField(blank=True)),
                ('campus', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_items', to='tenants.campus')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('deleted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_deleted', to=settings.AUTH_USER_MODEL)),
                ('esd_element', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='suppliers', to='corporate.esdelement')),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'ESD Supplier',
                'verbose_name_plural': 'ESD Suppliers',
                'ordering': ['supplier_name'],
            },
        ),
        migrations.CreateModel(
            name='ManagementControlProfile',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_deleted', models.BooleanField(default=False)),
                ('deleted_at', models.DateTimeField(blank=True, null=True)),
                ('board_total', models.PositiveIntegerField(default=0)),
                ('board_black', models.PositiveIntegerField(default=0)),
                ('board_black_female', models.PositiveIntegerField(default=0)),
                ('board_black_executive', models.PositiveIntegerField(default=0, help_text='Black executive directors')),
                ('board_black_independent', models.PositiveIntegerField(default=0, help_text='Black independent non-exec directors')),
                ('exec_total', models.PositiveIntegerField(default=0)),
                ('exec_black', models.PositiveIntegerField(default=0)),
                ('exec_black_female', models.PositiveIntegerField(default=0)),
                ('senior_mgmt_total', models.PositiveIntegerField(default=0)),
                ('senior_mgmt_black', models.PositiveIntegerField(default=0)),
                ('senior_mgmt_black_female', models.PositiveIntegerField(default=0)),
                ('middle_mgmt_total', models.PositiveIntegerField(default=0)),
                ('middle_mgmt_black', models.PositiveIntegerField(default=0)),
                ('middle_mgmt_black_female', models.PositiveIntegerField(default=0)),
                ('junior_mgmt_total', models.PositiveIntegerField(default=0)),
                ('junior_mgmt_black', models.PositiveIntegerField(default=0)),
                ('junior_mgmt_black_female', models.PositiveIntegerField(default=0)),
                ('disabled_in_management', models.PositiveIntegerField(default=0)),
                ('calculated_score', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=5)),
                ('notes', models.TextField(blank=True)),
                ('campus', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_items', to='tenants.campus')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('deleted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_deleted', to=settings.AUTH_USER_MODEL)),
                ('service_year', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='management_profile', to='corporate.bbbeeserviceyear')),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Management Control Profile',
                'verbose_name_plural': 'Management Control Profiles',
            },
        ),
        migrations.CreateModel(
            name='OwnershipStructure',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_deleted', models.BooleanField(default=False)),
                ('deleted_at', models.DateTimeField(blank=True, null=True)),
                ('total_shares_issued', models.PositiveIntegerField(default=0)),
                ('total_black_voting_rights', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Total black voting rights %', max_digits=5)),
                ('total_black_economic_interest', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Total black economic interest %', max_digits=5)),
                ('black_women_voting_rights', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Black women voting rights %', max_digits=5)),
                ('black_women_economic_interest', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Black women economic interest %', max_digits=5)),
                ('has_new_entrants', models.BooleanField(default=False, help_text='Ownership includes new entrants (previously disadvantaged)')),
                ('new_entrant_percentage', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='% ownership by new entrants', max_digits=5)),
                ('ownership_fulfilled', models.BooleanField(default=False, help_text='Ownership is fully vested (not vendor-financed/encumbered)')),
                ('calculated_score', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=5)),
                ('notes', models.TextField(blank=True)),
                ('campus', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_items', to='tenants.campus')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('deleted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_deleted', to=settings.AUTH_USER_MODEL)),
                ('service_year', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='ownership_structure', to='corporate.bbbeeserviceyear')),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Ownership Structure',
                'verbose_name_plural': 'Ownership Structures',
            },
        ),
        migrations.CreateModel(
            name='SEDElement',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_deleted', models.BooleanField(default=False)),
                ('deleted_at', models.DateTimeField(blank=True, null=True)),
                ('npat', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Net Profit After Tax', max_digits=14)),
                ('total_sed_spend', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=14)),
                ('total_beneficiaries', models.PositiveIntegerField(default=0)),
                ('black_beneficiaries', models.PositiveIntegerField(default=0)),
                ('calculated_score', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=5)),
                ('notes', models.TextField(blank=True)),
                ('campus', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_items', to='tenants.campus')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('deleted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_deleted', to=settings.AUTH_USER_MODEL)),
                ('service_year', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='sed_element', to='corporate.bbbeeserviceyear')),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'SED Element',
                'verbose_name_plural': 'SED Elements',
            },
        ),
        migrations.CreateModel(
            name='SEDContribution',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_deleted', models.BooleanField(default=False)),
                ('deleted_at', models.DateTimeField(blank=True, null=True)),
                ('contribution_type', models.CharField(choices=[('MONETARY', 'Monetary Donation'), ('IN_KIND', 'In-Kind Contribution'), ('TIME', 'Time/Pro-Bono Services'), ('SPONSORSHIP', 'Sponsorship'), ('BURSARY', 'Bursary/Educational Support'), ('OTHER', 'Other')], max_length=20)),
                ('beneficiary_name', models.CharField(max_length=200)),
                ('beneficiary_type', models.CharField(blank=True, help_text='e.g., NPO, School, Community Project', max_length=100)),
                ('npo_number', models.CharField(blank=True, help_text='NPO registration number', max_length=50)),
                ('black_beneficiary_percentage', models.DecimalField(decimal_places=2, default=Decimal('75.00'), help_text='% of beneficiaries that are black (must be 75%+)', max_digits=5)),
                ('description', models.TextField(blank=True)),
                ('contribution_date', models.DateField()),
                ('monetary_value', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=14)),
                ('proof_document', models.FileField(blank=True, null=True, upload_to='bbbee_sed_proof/')),
                ('notes', models.TextField(blank=True)),
                ('campus', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_items', to='tenants.campus')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('deleted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_deleted', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
                ('sed_element', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='contributions', to='corporate.sedelement')),
            ],
            options={
                'verbose_name': 'SED Contribution',
                'verbose_name_plural': 'SED Contributions',
                'ordering': ['-contribution_date'],
            },
        ),
        migrations.CreateModel(
            name='Shareholder',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_deleted', models.BooleanField(default=False)),
                ('deleted_at', models.DateTimeField(blank=True, null=True)),
                ('shareholder_type', models.CharField(choices=[('INDIVIDUAL', 'Individual'), ('COMPANY', 'Company/Entity'), ('TRUST', 'Trust'), ('ESOP', 'Employee Share Ownership Programme'), ('BROAD_BASED', 'Broad-Based Ownership Scheme')], max_length=20)),
                ('name', models.CharField(max_length=200)),
                ('id_number', models.CharField(blank=True, help_text='SA ID number (individuals)', max_length=20)),
                ('registration_number', models.CharField(blank=True, help_text='Company registration (entities)', max_length=50)),
                ('demographic', models.CharField(blank=True, choices=[('BLACK_MALE', 'Black Male'), ('BLACK_FEMALE', 'Black Female'), ('COLOURED_MALE', 'Coloured Male'), ('COLOURED_FEMALE', 'Coloured Female'), ('INDIAN_MALE', 'Indian Male'), ('INDIAN_FEMALE', 'Indian Female'), ('WHITE_MALE', 'White Male'), ('WHITE_FEMALE', 'White Female'), ('NON_SA', 'Non-South African'), ('ENTITY', 'Entity (Flow-through)')], max_length=20)),
                ('is_black', models.BooleanField(default=False)),
                ('is_female', models.BooleanField(default=False)),
                ('is_disabled', models.BooleanField(default=False)),
                ('is_youth', models.BooleanField(default=False, help_text='Under 35 years old')),
                ('is_new_entrant', models.BooleanField(default=False, help_text='New entrant (previously disadvantaged with no prior significant ownership)')),
                ('shares_held', models.PositiveIntegerField(default=0)),
                ('voting_rights_percentage', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=5)),
                ('economic_interest_percentage', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=5)),
                ('entity_bbbee_level', models.PositiveIntegerField(blank=True, help_text='B-BBEE level of entity shareholder (for flow-through)', null=True)),
                ('entity_black_ownership', models.DecimalField(blank=True, decimal_places=2, help_text='Black ownership % of entity shareholder', max_digits=5, null=True)),
                ('is_fully_vested', models.BooleanField(default=True, help_text='Shares are fully vested (not under vendor financing)')),
                ('vesting_date', models.DateField(blank=True, null=True)),
                ('campus', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_items', to='tenants.campus')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('deleted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_deleted', to=settings.AUTH_USER_MODEL)),
                ('ownership_structure', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='shareholders', to='corporate.ownershipstructure')),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Shareholder',
                'verbose_name_plural': 'Shareholders',
                'ordering': ['-voting_rights_percentage'],
            },
        ),
        migrations.CreateModel(
            name='SkillsDevelopmentElement',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_deleted', models.BooleanField(default=False)),
                ('deleted_at', models.DateTimeField(blank=True, null=True)),
                ('leviable_amount', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Annual leviable payroll amount', max_digits=14)),
                ('total_skills_spend', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=14)),
                ('black_skills_spend', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=14)),
                ('black_female_skills_spend', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=14)),
                ('black_disabled_skills_spend', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=14)),
                ('learnerships_total', models.PositiveIntegerField(default=0)),
                ('learnerships_black', models.PositiveIntegerField(default=0)),
                ('learnerships_black_female', models.PositiveIntegerField(default=0)),
                ('learnerships_black_disabled', models.PositiveIntegerField(default=0)),
                ('learnerships_black_youth', models.PositiveIntegerField(default=0)),
                ('internships_total', models.PositiveIntegerField(default=0)),
                ('internships_black', models.PositiveIntegerField(default=0)),
                ('internships_absorbed', models.PositiveIntegerField(default=0, help_text='Interns absorbed into permanent employment')),
                ('bursaries_total', models.PositiveIntegerField(default=0)),
                ('bursaries_black', models.PositiveIntegerField(default=0)),
                ('bursaries_spend', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=14)),
                ('calculated_score', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=5)),
                ('notes', models.TextField(blank=True)),
                ('campus', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_items', to='tenants.campus')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('deleted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_deleted', to=settings.AUTH_USER_MODEL)),
                ('service_year', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='skills_development', to='corporate.bbbeeserviceyear')),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Skills Development Element',
                'verbose_name_plural': 'Skills Development Elements',
            },
        ),
        migrations.CreateModel(
            name='TransformationPlan',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_deleted', models.BooleanField(default=False)),
                ('deleted_at', models.DateTimeField(blank=True, null=True)),
                ('name', models.CharField(default='B-BBEE Transformation Plan', max_length=200)),
                ('start_date', models.DateField()),
                ('end_date', models.DateField()),
                ('status', models.CharField(choices=[('DRAFT', 'Draft'), ('ACTIVE', 'Active'), ('UNDER_REVIEW', 'Under Review'), ('COMPLETED', 'Completed'), ('SUPERSEDED', 'Superseded')], default='DRAFT', max_length=20)),
                ('current_level', models.PositiveIntegerField(blank=True, null=True)),
                ('target_level', models.PositiveIntegerField(blank=True, null=True)),
                ('ownership_target', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('management_control_target', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('skills_development_target', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('esd_target', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('sed_target', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('strategy_document', models.FileField(blank=True, null=True, upload_to='bbbee_transformation_plans/')),
                ('initiatives', models.JSONField(default=list, help_text='List of transformation initiatives')),
                ('notes', models.TextField(blank=True)),
                ('campus', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_items', to='tenants.campus')),
                ('client', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='transformation_plans', to='corporate.corporateclient')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('deleted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_deleted', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Transformation Plan',
                'verbose_name_plural': 'Transformation Plans',
                'ordering': ['-start_date'],
            },
        ),
    ]

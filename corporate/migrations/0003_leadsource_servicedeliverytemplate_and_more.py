# Generated by Django 5.2.8 on 2025-12-02 10:46

import django.core.validators
import django.db.models.deletion
from decimal import Decimal
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('core', '0007_tranche_payment_system'),
        ('corporate', '0002_add_service_catalog_and_host_employer'),
        ('tenants', '0001_initial'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='LeadSource',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=100)),
                ('code', models.CharField(max_length=20, unique=True)),
                ('description', models.TextField(blank=True)),
                ('is_active', models.BooleanField(default=True)),
            ],
            options={
                'verbose_name': 'Lead Source',
                'verbose_name_plural': 'Lead Sources',
                'ordering': ['name'],
            },
        ),
        migrations.CreateModel(
            name='ServiceDeliveryTemplate',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('service_type', models.CharField(choices=[('HOST_EMPLOYMENT', 'Host Employment'), ('WSP_ATR', 'WSP/ATR Submissions'), ('DG_APPLICATION', 'Discretionary Grant Applications'), ('EE_CONSULTING', 'Employment Equity Consulting'), ('BEE_CONSULTING', 'BBBEE Consulting'), ('TRANCHE_ADMIN', 'Tranche Administration'), ('SDF_SERVICES', 'SDF Services'), ('LEARNERSHIP', 'Learnership Programme'), ('APPRENTICESHIP', 'Apprenticeship Programme'), ('SKILLS_PROGRAMME', 'Skills Programme'), ('SHORT_COURSE', 'Short Course'), ('INTERNSHIP', 'Internship Programme'), ('TRADE_TEST_ADMIN', 'Trade Test Administration'), ('QCTO_ADMIN', 'QCTO Administration'), ('CERTIFICATION', 'Certification Services'), ('CUSTOM', 'Custom Service')], max_length=30, unique=True)),
                ('name', models.CharField(max_length=200)),
                ('description', models.TextField(blank=True)),
                ('default_duration_days', models.PositiveIntegerField(default=30)),
                ('is_active', models.BooleanField(default=True)),
            ],
            options={
                'verbose_name': 'Service Delivery Template',
                'verbose_name_plural': 'Service Delivery Templates',
                'ordering': ['name'],
            },
        ),
        migrations.AlterModelOptions(
            name='projecttask',
            options={'ordering': ['priority', 'due_date'], 'verbose_name': 'Project Task', 'verbose_name_plural': 'Project Tasks'},
        ),
        migrations.RemoveField(
            model_name='projecttask',
            name='project',
        ),
        migrations.AddField(
            model_name='clientservicesubscription',
            name='last_review_date',
            field=models.DateField(blank=True, null=True),
        ),
        migrations.AddField(
            model_name='clientservicesubscription',
            name='renewal_reminder_date',
            field=models.DateField(blank=True, null=True),
        ),
        migrations.AddField(
            model_name='clientservicesubscription',
            name='renewal_reminder_sent',
            field=models.BooleanField(default=False),
        ),
        migrations.AddField(
            model_name='clientservicesubscription',
            name='satisfaction_score',
            field=models.PositiveIntegerField(blank=True, help_text='Client satisfaction score (1-5)', null=True, validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(5)]),
        ),
        migrations.AddField(
            model_name='corporateclient',
            name='client_tier',
            field=models.CharField(choices=[('STRATEGIC', 'Strategic'), ('KEY', 'Key Account'), ('STANDARD', 'Standard'), ('EMERGING', 'Emerging')], default='STANDARD', max_length=20),
        ),
        migrations.AddField(
            model_name='corporateclient',
            name='conversion_date',
            field=models.DateField(blank=True, help_text='Date prospect became active client', null=True),
        ),
        migrations.AddField(
            model_name='corporateclient',
            name='first_contact_date',
            field=models.DateField(blank=True, null=True),
        ),
        migrations.AddField(
            model_name='corporateclient',
            name='health_score',
            field=models.PositiveIntegerField(blank=True, help_text='Client health score (1-100)', null=True, validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(100)]),
        ),
        migrations.AddField(
            model_name='corporateclient',
            name='health_score_updated',
            field=models.DateTimeField(blank=True, null=True),
        ),
        migrations.AddField(
            model_name='corporateclient',
            name='lifetime_value',
            field=models.DecimalField(blank=True, decimal_places=2, help_text='Total revenue from this client', max_digits=14, null=True),
        ),
        migrations.AddField(
            model_name='corporatecontact',
            name='birthday',
            field=models.DateField(blank=True, null=True),
        ),
        migrations.AddField(
            model_name='corporatecontact',
            name='engagement_score',
            field=models.PositiveIntegerField(blank=True, help_text='Engagement score (1-100)', null=True, validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(100)]),
        ),
        migrations.AddField(
            model_name='corporatecontact',
            name='influence_level',
            field=models.CharField(choices=[('DECISION_MAKER', 'Decision Maker'), ('INFLUENCER', 'Influencer'), ('CHAMPION', 'Champion'), ('BLOCKER', 'Blocker'), ('END_USER', 'End User'), ('UNKNOWN', 'Unknown')], default='UNKNOWN', max_length=20),
        ),
        migrations.AddField(
            model_name='corporatecontact',
            name='last_contacted',
            field=models.DateField(blank=True, null=True),
        ),
        migrations.AddField(
            model_name='corporatecontact',
            name='linkedin_url',
            field=models.URLField(blank=True),
        ),
        migrations.AddField(
            model_name='corporatecontact',
            name='notes',
            field=models.TextField(blank=True),
        ),
        migrations.AddField(
            model_name='corporatecontact',
            name='preferred_contact_method',
            field=models.CharField(blank=True, max_length=20),
        ),
        migrations.AddField(
            model_name='projecttask',
            name='actual_hours',
            field=models.DecimalField(blank=True, decimal_places=2, max_digits=6, null=True),
        ),
        migrations.AddField(
            model_name='projecttask',
            name='estimated_hours',
            field=models.DecimalField(blank=True, decimal_places=2, max_digits=6, null=True),
        ),
        migrations.AddField(
            model_name='projecttask',
            name='priority',
            field=models.CharField(choices=[('LOW', 'Low'), ('MEDIUM', 'Medium'), ('HIGH', 'High'), ('URGENT', 'Urgent')], default='MEDIUM', max_length=10),
        ),
        migrations.AlterField(
            model_name='projecttask',
            name='assigned_to',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='project_tasks', to=settings.AUTH_USER_MODEL),
        ),
        migrations.CreateModel(
            name='ClientProjectTask',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_deleted', models.BooleanField(default=False)),
                ('deleted_at', models.DateTimeField(blank=True, null=True)),
                ('title', models.CharField(max_length=200)),
                ('description', models.TextField(blank=True)),
                ('status', models.CharField(choices=[('TODO', 'To Do'), ('IN_PROGRESS', 'In Progress'), ('BLOCKED', 'Blocked'), ('DONE', 'Done')], default='TODO', max_length=20)),
                ('due_date', models.DateField(blank=True, null=True)),
                ('completed_date', models.DateField(blank=True, null=True)),
                ('assigned_to', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='client_project_tasks', to=settings.AUTH_USER_MODEL)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('deleted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_deleted', to=settings.AUTH_USER_MODEL)),
                ('project', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='tasks', to='corporate.clientproject')),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Client Project Task',
                'verbose_name_plural': 'Client Project Tasks',
                'ordering': ['status', 'due_date'],
            },
        ),
        migrations.CreateModel(
            name='CorporateOpportunity',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_deleted', models.BooleanField(default=False)),
                ('deleted_at', models.DateTimeField(blank=True, null=True)),
                ('reference_number', models.CharField(editable=False, max_length=20, unique=True)),
                ('prospect_company_name', models.CharField(blank=True, max_length=200)),
                ('prospect_contact_name', models.CharField(blank=True, max_length=100)),
                ('prospect_email', models.EmailField(blank=True, max_length=254)),
                ('prospect_phone', models.CharField(blank=True, max_length=20)),
                ('title', models.CharField(max_length=200)),
                ('description', models.TextField(blank=True)),
                ('opportunity_type', models.CharField(choices=[('NEW_CLIENT', 'New Client'), ('NEW_SERVICE', 'New Service (Existing Client)'), ('UPSELL', 'Upsell'), ('CROSS_SELL', 'Cross-sell'), ('RENEWAL', 'Renewal'), ('EXPANSION', 'Expansion')], default='NEW_CLIENT', max_length=20)),
                ('stage', models.CharField(choices=[('IDENTIFIED', 'Identified'), ('QUALIFIED', 'Qualified'), ('NEEDS_ANALYSIS', 'Needs Analysis'), ('PROPOSAL', 'Proposal Sent'), ('NEGOTIATION', 'Negotiation'), ('CLOSED_WON', 'Closed Won'), ('CLOSED_LOST', 'Closed Lost'), ('ON_HOLD', 'On Hold')], default='IDENTIFIED', max_length=20)),
                ('stage_changed_date', models.DateField(auto_now=True)),
                ('estimated_value', models.DecimalField(blank=True, decimal_places=2, help_text='Estimated total deal value', max_digits=12, null=True)),
                ('probability', models.PositiveIntegerField(default=50, help_text='Win probability percentage', validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(100)])),
                ('expected_close_date', models.DateField(blank=True, null=True)),
                ('actual_close_date', models.DateField(blank=True, null=True)),
                ('referral_source', models.CharField(blank=True, max_length=200)),
                ('priority', models.CharField(choices=[('LOW', 'Low'), ('MEDIUM', 'Medium'), ('HIGH', 'High'), ('CRITICAL', 'Critical')], default='MEDIUM', max_length=10)),
                ('loss_reason', models.TextField(blank=True)),
                ('competitor', models.CharField(blank=True, max_length=200)),
                ('notes', models.TextField(blank=True)),
                ('campus', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_items', to='tenants.campus')),
                ('client', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='opportunities', to='corporate.corporateclient')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('deleted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_deleted', to=settings.AUTH_USER_MODEL)),
                ('proposed_services', models.ManyToManyField(blank=True, related_name='opportunities', to='corporate.serviceoffering')),
                ('sales_owner', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='owned_opportunities', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
                ('lead_source', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='opportunities', to='corporate.leadsource')),
            ],
            options={
                'verbose_name': 'Corporate Opportunity',
                'verbose_name_plural': 'Corporate Opportunities',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='CorporateActivity',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_deleted', models.BooleanField(default=False)),
                ('deleted_at', models.DateTimeField(blank=True, null=True)),
                ('activity_type', models.CharField(choices=[('CALL', 'Phone Call'), ('EMAIL', 'Email'), ('MEETING', 'Meeting'), ('VIDEO_CALL', 'Video Call'), ('SITE_VISIT', 'Site Visit'), ('PROPOSAL_SENT', 'Proposal Sent'), ('PRESENTATION', 'Presentation'), ('FOLLOW_UP', 'Follow-up'), ('NOTE', 'Note'), ('TASK', 'Task')], max_length=20)),
                ('subject', models.CharField(max_length=200)),
                ('description', models.TextField(blank=True)),
                ('activity_date', models.DateTimeField()),
                ('duration_minutes', models.PositiveIntegerField(blank=True, null=True)),
                ('participants', models.TextField(blank=True, help_text='Other participants')),
                ('outcome', models.CharField(blank=True, choices=[('POSITIVE', 'Positive'), ('NEUTRAL', 'Neutral'), ('NEGATIVE', 'Negative'), ('NO_ANSWER', 'No Answer'), ('CALLBACK', 'Callback Requested')], max_length=20)),
                ('outcome_notes', models.TextField(blank=True)),
                ('next_action', models.CharField(blank=True, max_length=200)),
                ('next_action_date', models.DateField(blank=True, null=True)),
                ('is_completed', models.BooleanField(default=False)),
                ('completed_date', models.DateField(blank=True, null=True)),
                ('client', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='activities', to='corporate.corporateclient')),
                ('contact', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='activities', to='corporate.corporatecontact')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('deleted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_deleted', to=settings.AUTH_USER_MODEL)),
                ('follow_up_assigned_to', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='assigned_follow_ups', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
                ('opportunity', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='activities', to='corporate.corporateopportunity')),
            ],
            options={
                'verbose_name': 'Corporate Activity',
                'verbose_name_plural': 'Corporate Activities',
                'ordering': ['-activity_date'],
            },
        ),
        migrations.AddField(
            model_name='clientservicesubscription',
            name='opportunity_source',
            field=models.ForeignKey(blank=True, help_text='The opportunity that resulted in this subscription', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='resulting_subscriptions', to='corporate.corporateopportunity'),
        ),
        migrations.AddField(
            model_name='corporateclient',
            name='lead_source',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='clients', to='corporate.leadsource'),
        ),
        migrations.CreateModel(
            name='ProjectMilestone',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_deleted', models.BooleanField(default=False)),
                ('deleted_at', models.DateTimeField(blank=True, null=True)),
                ('name', models.CharField(max_length=200)),
                ('description', models.TextField(blank=True)),
                ('sequence', models.PositiveIntegerField(default=1)),
                ('status', models.CharField(choices=[('NOT_STARTED', 'Not Started'), ('IN_PROGRESS', 'In Progress'), ('BLOCKED', 'Blocked'), ('COMPLETED', 'Completed'), ('SKIPPED', 'Skipped')], default='NOT_STARTED', max_length=20)),
                ('planned_start_date', models.DateField(blank=True, null=True)),
                ('planned_end_date', models.DateField(blank=True, null=True)),
                ('actual_start_date', models.DateField(blank=True, null=True)),
                ('actual_end_date', models.DateField(blank=True, null=True)),
                ('weight', models.PositiveIntegerField(default=1)),
                ('requires_evidence', models.BooleanField(default=False)),
                ('evidence_description', models.TextField(blank=True)),
                ('notes', models.TextField(blank=True)),
                ('assigned_to', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='assigned_milestones', to=settings.AUTH_USER_MODEL)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('deleted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_deleted', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Project Milestone',
                'verbose_name_plural': 'Project Milestones',
                'ordering': ['sequence'],
            },
        ),
        migrations.AddField(
            model_name='projecttask',
            name='milestone',
            field=models.ForeignKey(default=1, on_delete=django.db.models.deletion.CASCADE, related_name='tasks', to='corporate.projectmilestone'),
            preserve_default=False,
        ),
        migrations.CreateModel(
            name='ServiceDeliveryProject',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_deleted', models.BooleanField(default=False)),
                ('deleted_at', models.DateTimeField(blank=True, null=True)),
                ('project_number', models.CharField(editable=False, max_length=20, unique=True)),
                ('name', models.CharField(max_length=200)),
                ('description', models.TextField(blank=True)),
                ('status', models.CharField(choices=[('SETUP', 'Setup/Onboarding'), ('PLANNING', 'Planning'), ('IN_PROGRESS', 'In Progress'), ('ON_HOLD', 'On Hold'), ('REVIEW', 'Under Review'), ('COMPLETED', 'Completed'), ('CANCELLED', 'Cancelled')], default='SETUP', max_length=20)),
                ('health', models.CharField(choices=[('GREEN', 'On Track'), ('AMBER', 'At Risk'), ('RED', 'Critical')], default='GREEN', max_length=10)),
                ('health_notes', models.TextField(blank=True)),
                ('progress_percentage', models.PositiveIntegerField(default=0, validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(100)])),
                ('planned_start_date', models.DateField(blank=True, null=True)),
                ('actual_start_date', models.DateField(blank=True, null=True)),
                ('planned_end_date', models.DateField(blank=True, null=True)),
                ('actual_end_date', models.DateField(blank=True, null=True)),
                ('budget', models.DecimalField(blank=True, decimal_places=2, max_digits=12, null=True)),
                ('actual_cost', models.DecimalField(blank=True, decimal_places=2, max_digits=12, null=True)),
                ('notes', models.TextField(blank=True)),
                ('campus', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_items', to='tenants.campus')),
                ('client', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='delivery_projects', to='corporate.corporateclient')),
                ('client_contact', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='delivery_projects', to='corporate.corporatecontact')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('deleted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_deleted', to=settings.AUTH_USER_MODEL)),
                ('project_manager', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='managed_delivery_projects', to=settings.AUTH_USER_MODEL)),
                ('subscription', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='delivery_project', to='corporate.clientservicesubscription')),
                ('team_members', models.ManyToManyField(blank=True, related_name='delivery_project_teams', to=settings.AUTH_USER_MODEL)),
                ('training_notification', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='delivery_projects', to='core.trainingnotification')),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Service Delivery Project',
                'verbose_name_plural': 'Service Delivery Projects',
                'ordering': ['-created_at'],
            },
        ),
        migrations.AddField(
            model_name='projectmilestone',
            name='project',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='milestones', to='corporate.servicedeliveryproject'),
        ),
        migrations.CreateModel(
            name='ProjectDocument',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_deleted', models.BooleanField(default=False)),
                ('deleted_at', models.DateTimeField(blank=True, null=True)),
                ('name', models.CharField(max_length=200)),
                ('document_type', models.CharField(choices=[('CONTRACT', 'Contract'), ('PROPOSAL', 'Proposal'), ('REPORT', 'Report'), ('EVIDENCE', 'Evidence'), ('CORRESPONDENCE', 'Correspondence'), ('DELIVERABLE', 'Deliverable'), ('OTHER', 'Other')], max_length=20)),
                ('description', models.TextField(blank=True)),
                ('file', models.FileField(upload_to='project_documents/')),
                ('file_size', models.PositiveIntegerField(blank=True, null=True)),
                ('upload_date', models.DateTimeField(auto_now_add=True)),
                ('version', models.CharField(default='1.0', max_length=20)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('deleted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_deleted', to=settings.AUTH_USER_MODEL)),
                ('replaces', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='replaced_by', to='corporate.projectdocument')),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
                ('uploaded_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='uploaded_project_documents', to=settings.AUTH_USER_MODEL)),
                ('milestone', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='documents', to='corporate.projectmilestone')),
                ('project', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='documents', to='corporate.servicedeliveryproject')),
            ],
            options={
                'verbose_name': 'Project Document',
                'verbose_name_plural': 'Project Documents',
                'ordering': ['-upload_date'],
            },
        ),
        migrations.CreateModel(
            name='ServiceDeliveryTemplateMilestone',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=200)),
                ('description', models.TextField(blank=True)),
                ('sequence', models.PositiveIntegerField(default=1)),
                ('days_from_start', models.PositiveIntegerField(default=0)),
                ('duration_days', models.PositiveIntegerField(default=7)),
                ('weight', models.PositiveIntegerField(default=1)),
                ('requires_evidence', models.BooleanField(default=False)),
                ('evidence_description', models.TextField(blank=True)),
                ('template', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='milestones', to='corporate.servicedeliverytemplate')),
            ],
            options={
                'verbose_name': 'Template Milestone',
                'verbose_name_plural': 'Template Milestones',
                'ordering': ['sequence'],
            },
        ),
        migrations.CreateModel(
            name='ServiceProposal',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_deleted', models.BooleanField(default=False)),
                ('deleted_at', models.DateTimeField(blank=True, null=True)),
                ('proposal_number', models.CharField(editable=False, max_length=20, unique=True)),
                ('title', models.CharField(max_length=200)),
                ('introduction', models.TextField(blank=True, help_text='Introduction/cover letter text')),
                ('scope_of_work', models.TextField(blank=True)),
                ('terms_and_conditions', models.TextField(blank=True)),
                ('status', models.CharField(choices=[('DRAFT', 'Draft'), ('INTERNAL_REVIEW', 'Internal Review'), ('SENT', 'Sent to Client'), ('VIEWED', 'Viewed by Client'), ('UNDER_CONSIDERATION', 'Under Consideration'), ('REVISION_REQUESTED', 'Revision Requested'), ('ACCEPTED', 'Accepted'), ('REJECTED', 'Rejected'), ('EXPIRED', 'Expired')], default='DRAFT', max_length=20)),
                ('proposal_date', models.DateField(auto_now_add=True)),
                ('valid_until', models.DateField(blank=True, null=True)),
                ('sent_date', models.DateTimeField(blank=True, null=True)),
                ('viewed_date', models.DateTimeField(blank=True, null=True)),
                ('response_date', models.DateTimeField(blank=True, null=True)),
                ('subtotal', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=12)),
                ('discount_percentage', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=5)),
                ('discount_amount', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=12)),
                ('vat_percentage', models.DecimalField(decimal_places=2, default=Decimal('15.00'), max_digits=5)),
                ('vat_amount', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=12)),
                ('total_amount', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=12)),
                ('proposal_document', models.FileField(blank=True, upload_to='proposals/')),
                ('rejection_reason', models.TextField(blank=True)),
                ('client_feedback', models.TextField(blank=True)),
                ('notes', models.TextField(blank=True)),
                ('campus', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_items', to='tenants.campus')),
                ('client', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='proposals', to='corporate.corporateclient')),
                ('contact_person', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='proposals_received', to='corporate.corporatecontact')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('deleted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_deleted', to=settings.AUTH_USER_MODEL)),
                ('opportunity', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='proposals', to='corporate.corporateopportunity')),
                ('prepared_by', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='prepared_proposals', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Service Proposal',
                'verbose_name_plural': 'Service Proposals',
                'ordering': ['-proposal_date'],
            },
        ),
        migrations.CreateModel(
            name='ProposalLineItem',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('description', models.CharField(max_length=500)),
                ('details', models.TextField(blank=True)),
                ('quantity', models.DecimalField(decimal_places=2, default=Decimal('1.00'), max_digits=10)),
                ('unit', models.CharField(default='each', max_length=50)),
                ('unit_price', models.DecimalField(decimal_places=2, max_digits=12)),
                ('sequence', models.PositiveIntegerField(default=0)),
                ('service', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='proposal_lines', to='corporate.serviceoffering')),
                ('proposal', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='line_items', to='corporate.serviceproposal')),
            ],
            options={
                'verbose_name': 'Proposal Line Item',
                'verbose_name_plural': 'Proposal Line Items',
                'ordering': ['sequence'],
            },
        ),
        migrations.AddField(
            model_name='clientservicesubscription',
            name='proposal_source',
            field=models.ForeignKey(blank=True, help_text='The proposal that was accepted for this subscription', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='resulting_subscriptions', to='corporate.serviceproposal'),
        ),
    ]

{% extends 'base/app_layout.html' %}
{% load static %}

{% block title %}{{ title }}{% endblock %}

{% block page_header %}
<div class="flex flex-col sm:flex-row sm:items-center sm:justify-between">
    <div>
        <h1 class="text-2xl font-bold text-gray-900">{{ title }}</h1>
        <p class="mt-1 text-sm text-gray-500">
            {% if object %}Edit qualification details{% else %}Add a new qualification to the system{% endif %}
        </p>
    </div>
    <div class="mt-4 sm:mt-0">
        <a href="{% url 'academics:qualification_list' %}" class="inline-flex items-center px-4 py-2 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50">
            <i class="fas fa-arrow-left mr-2"></i>Back to List
        </a>
    </div>
</div>
{% endblock %}

{% block content %}
<form method="post" enctype="multipart/form-data" class="space-y-6">
    {% csrf_token %}
    
    <!-- Form Errors -->
    {% if form.errors %}
    <div class="bg-red-50 border border-red-200 rounded-xl p-4">
        <div class="flex items-start">
            <i class="fas fa-exclamation-circle text-red-500 mt-0.5 mr-3"></i>
            <div>
                <h3 class="text-sm font-medium text-red-800">Please correct the following errors:</h3>
                <ul class="mt-2 text-sm text-red-700 list-disc list-inside">
                    {% for field in form %}
                        {% for error in field.errors %}
                        <li><strong>{{ field.label }}:</strong> {{ error }}</li>
                        {% endfor %}
                    {% endfor %}
                    {% for error in form.non_field_errors %}
                    <li>{{ error }}</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>
    {% endif %}
    
    <!-- Basic Information -->
    <div class="bg-white rounded-xl shadow-sm border border-gray-100 p-6">
        <h2 class="text-lg font-semibold text-gray-900 mb-4">
            <i class="fas fa-info-circle text-purple-600 mr-2"></i>Basic Information
        </h2>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <div>
                <label for="id_saqa_id" class="block text-sm font-medium text-gray-700 mb-1">SAQA ID *</label>
                {{ form.saqa_id }}
                {% if form.saqa_id.errors %}<p class="mt-1 text-sm text-red-600">{{ form.saqa_id.errors.0 }}</p>{% endif %}
            </div>
            <div class="md:col-span-2">
                <label for="id_title" class="block text-sm font-medium text-gray-700 mb-1">Full Title *</label>
                {{ form.title }}
                {% if form.title.errors %}<p class="mt-1 text-sm text-red-600">{{ form.title.errors.0 }}</p>{% endif %}
            </div>
            <div>
                <label for="id_short_title" class="block text-sm font-medium text-gray-700 mb-1">Short Title *</label>
                {{ form.short_title }}
                {% if form.short_title.errors %}<p class="mt-1 text-sm text-red-600">{{ form.short_title.errors.0 }}</p>{% endif %}
            </div>
            <div>
                <label for="id_qualification_type" class="block text-sm font-medium text-gray-700 mb-1">Type *</label>
                {{ form.qualification_type }}
            </div>
            <div>
                <label for="id_seta" class="block text-sm font-medium text-gray-700 mb-1">SETA *</label>
                {{ form.seta }}
            </div>
        </div>
    </div>
    
    <!-- Classification -->
    <div class="bg-white rounded-xl shadow-sm border border-gray-100 p-6">
        <h2 class="text-lg font-semibold text-gray-900 mb-4">
            <i class="fas fa-layer-group text-blue-600 mr-2"></i>Classification
        </h2>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
            <div>
                <label for="id_nqf_level" class="block text-sm font-medium text-gray-700 mb-1">NQF Level *</label>
                {{ form.nqf_level }}
                <p class="mt-1 text-xs text-gray-500">Level 1-10</p>
            </div>
            <div>
                <label for="id_credits" class="block text-sm font-medium text-gray-700 mb-1">Credits *</label>
                {{ form.credits }}
            </div>
            <div>
                <label for="id_minimum_duration_months" class="block text-sm font-medium text-gray-700 mb-1">Min Duration (months) *</label>
                {{ form.minimum_duration_months }}
            </div>
            <div>
                <label for="id_maximum_duration_months" class="block text-sm font-medium text-gray-700 mb-1">Max Duration (months) *</label>
                {{ form.maximum_duration_months }}
            </div>
        </div>
    </div>
    
    <!-- Registration Dates -->
    <div class="bg-white rounded-xl shadow-sm border border-gray-100 p-6">
        <h2 class="text-lg font-semibold text-gray-900 mb-4">
            <i class="fas fa-calendar-alt text-green-600 mr-2"></i>SAQA Registration
        </h2>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <div>
                <label for="id_registration_start" class="block text-sm font-medium text-gray-700 mb-1">Registration Start *</label>
                {{ form.registration_start }}
            </div>
            <div>
                <label for="id_registration_end" class="block text-sm font-medium text-gray-700 mb-1">Registration End *</label>
                {{ form.registration_end }}
            </div>
            <div>
                <label for="id_last_enrollment_date" class="block text-sm font-medium text-gray-700 mb-1">Last Enrollment Date *</label>
                {{ form.last_enrollment_date }}
            </div>
        </div>
    </div>
    
    <!-- Accreditation -->
    <div class="bg-white rounded-xl shadow-sm border border-gray-100 p-6">
        <h2 class="text-lg font-semibold text-gray-900 mb-4">
            <i class="fas fa-certificate text-amber-600 mr-2"></i>Provider Accreditation
        </h2>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <div>
                <label for="id_qcto_code" class="block text-sm font-medium text-gray-700 mb-1">QCTO Code</label>
                {{ form.qcto_code }}
            </div>
            <div>
                <label for="id_accreditation_number" class="block text-sm font-medium text-gray-700 mb-1">Accreditation Number</label>
                {{ form.accreditation_number }}
            </div>
            <div>
                <label for="id_accreditation_start_date" class="block text-sm font-medium text-gray-700 mb-1">Accreditation Start</label>
                {{ form.accreditation_start_date }}
            </div>
            <div>
                <label for="id_accreditation_expiry" class="block text-sm font-medium text-gray-700 mb-1">Accreditation Expiry</label>
                {{ form.accreditation_expiry }}
            </div>
            <div class="md:col-span-2">
                <label for="id_accreditation_certificate" class="block text-sm font-medium text-gray-700 mb-1">Accreditation Certificate</label>
                {{ form.accreditation_certificate }}
                {% if object.accreditation_certificate %}
                <p class="mt-1 text-xs text-gray-500">
                    Current: <a href="{{ object.accreditation_certificate.url }}" target="_blank" class="text-purple-600 hover:underline">View current certificate</a>
                </p>
                {% endif %}
            </div>
        </div>
    </div>
    
    <!-- Delivery Readiness -->
    <div class="bg-white rounded-xl shadow-sm border border-gray-100 p-6">
        <h2 class="text-lg font-semibold text-gray-900 mb-4">
            <i class="fas fa-chalkboard-teacher text-indigo-600 mr-2"></i>Delivery Readiness
        </h2>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-4">
            <div class="flex items-center space-x-3 p-4 bg-gray-50 rounded-lg">
                {{ form.ready_in_person }}
                <label for="id_ready_in_person" class="text-sm font-medium text-gray-700">
                    <i class="fas fa-users text-gray-400 mr-1"></i>Ready for In-Person
                </label>
            </div>
            <div class="flex items-center space-x-3 p-4 bg-gray-50 rounded-lg">
                {{ form.ready_online }}
                <label for="id_ready_online" class="text-sm font-medium text-gray-700">
                    <i class="fas fa-laptop text-gray-400 mr-1"></i>Ready for Online
                </label>
            </div>
            <div class="flex items-center space-x-3 p-4 bg-gray-50 rounded-lg">
                {{ form.ready_hybrid }}
                <label for="id_ready_hybrid" class="text-sm font-medium text-gray-700">
                    <i class="fas fa-random text-gray-400 mr-1"></i>Ready for Hybrid
                </label>
            </div>
        </div>
        <div>
            <label for="id_delivery_notes" class="block text-sm font-medium text-gray-700 mb-1">Delivery Notes</label>
            {{ form.delivery_notes }}
        </div>
    </div>
    
    <!-- Status -->
    <div class="bg-white rounded-xl shadow-sm border border-gray-100 p-6">
        <h2 class="text-lg font-semibold text-gray-900 mb-4">
            <i class="fas fa-toggle-on text-gray-600 mr-2"></i>Status
        </h2>
        <div class="flex items-center space-x-3">
            {{ form.is_active }}
            <label for="id_is_active" class="text-sm font-medium text-gray-700">Active Qualification</label>
        </div>
        <p class="mt-1 text-xs text-gray-500">Inactive qualifications will not appear in enrollment options</p>
    </div>
    
    <!-- Form Actions -->
    <div class="flex items-center justify-end space-x-4">
        <a href="{% url 'academics:qualification_list' %}" class="px-6 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50">
            Cancel
        </a>
        <button type="submit" class="px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700">
            <i class="fas fa-save mr-2"></i>{{ submit_text }}
        </button>
    </div>
</form>
{% endblock %}

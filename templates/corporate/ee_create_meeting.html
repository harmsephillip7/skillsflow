{% extends 'base/app_layout.html' %}

{% block title %}Schedule EE Meeting - {{ client.company_name }}{% endblock %}

{% block breadcrumbs %}
<nav class="flex" aria-label="Breadcrumb">
    <ol class="inline-flex items-center space-x-1 md:space-x-3">
        <li><a href="{% url 'corporate:ee_clients_dashboard' %}" class="text-gray-700 hover:text-blue-600">EE Clients</a></li>
        <li><span class="mx-2 text-gray-400">/</span></li>
        <li><a href="{% url 'corporate:ee_service_management' client.pk %}" class="text-gray-700 hover:text-blue-600">{{ client.company_name }}</a></li>
        <li><span class="mx-2 text-gray-400">/</span></li>
        <li class="text-gray-500">Schedule Meeting</li>
    </ol>
</nav>
{% endblock %}

{% block main_content %}
<div class="mb-8">
    <h1 class="text-2xl font-bold text-gray-900">Schedule EE Meeting</h1>
    <p class="text-gray-500 mt-1">{{ client.company_name }}</p>
</div>

<div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
    <!-- Form -->
    <div class="lg:col-span-2">
        <div class="bg-white rounded-xl shadow-sm border border-gray-100 p-6">
            <form method="post" action="{% url 'corporate:ee_create_meeting' client.pk %}">
                {% csrf_token %}
                
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-1">Meeting Title</label>
                    <input type="text" name="title" class="w-full rounded-lg border-gray-300" placeholder="e.g., Q1 EE Committee Meeting" required>
                </div>

                <div class="grid grid-cols-2 gap-4 mb-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Date</label>
                        <input type="date" name="meeting_date" class="w-full rounded-lg border-gray-300" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Time</label>
                        <input type="time" name="meeting_time" class="w-full rounded-lg border-gray-300" value="10:00" required>
                    </div>
                </div>

                <div class="grid grid-cols-2 gap-4 mb-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Duration (minutes)</label>
                        <select name="duration_minutes" class="w-full rounded-lg border-gray-300">
                            <option value="30">30 minutes</option>
                            <option value="60" selected>1 hour</option>
                            <option value="90">1.5 hours</option>
                            <option value="120">2 hours</option>
                            <option value="180">3 hours</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Location</label>
                        <input type="text" name="location" class="w-full rounded-lg border-gray-300" placeholder="e.g., Boardroom, MS Teams">
                    </div>
                </div>

                <div class="grid grid-cols-2 gap-4 mb-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Meeting Type</label>
                        <select name="meeting_type" class="w-full rounded-lg border-gray-300">
                            <option value="COMMITTEE">Committee Meeting</option>
                            <option value="QUARTERLY">Quarterly Review</option>
                            <option value="SPECIAL">Special Meeting</option>
                            <option value="CONSULTATION">Consultation</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Meeting Purpose</label>
                        <select name="meeting_purpose" class="w-full rounded-lg border-gray-300">
                            <option value="EE_ONLY">EE Only</option>
                            <option value="COMBINED">Combined Training & EE</option>
                            <option value="TRAINING_ONLY">Training Only</option>
                        </select>
                    </div>
                </div>

                {% if committee %}
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-1">Committee</label>
                    <input type="hidden" name="committee_id" value="{{ committee.pk }}">
                    <div class="px-4 py-3 bg-gray-50 rounded-lg border border-gray-200">
                        <p class="font-medium text-gray-900">{{ committee.name }}</p>
                        <p class="text-sm text-gray-500">{{ committee.members.count }} members</p>
                    </div>
                </div>
                {% endif %}

                <!-- Template Selection -->
                {% if meeting_templates %}
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-1">Use Template (optional)</label>
                    <select name="template_id" class="w-full rounded-lg border-gray-300" onchange="loadTemplate(this.value)">
                        <option value="">-- Select a template --</option>
                        {% for template in meeting_templates %}
                        <option value="{{ template.pk }}">{{ template.title }}</option>
                        {% endfor %}
                    </select>
                </div>
                {% endif %}

                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-1">Agenda</label>
                    <textarea name="agenda" id="agenda" rows="8" class="w-full rounded-lg border-gray-300" placeholder="Enter the meeting agenda...">1. Welcome and apologies
2. Confirmation of previous minutes
3. Matters arising
4. EE Report review
5. Workforce profile analysis
6. Progress against numerical goals
7. Barriers to transformation
8. Affirmative action measures
9. General
10. Next meeting date</textarea>
                </div>

                <div class="mb-6">
                    <label class="flex items-center">
                        <input type="checkbox" name="send_invites" class="rounded border-gray-300 text-purple-600" checked>
                        <span class="ml-2 text-sm text-gray-700">Send meeting invitations to committee members</span>
                    </label>
                </div>

                <div class="flex justify-end space-x-3">
                    <a href="{% url 'corporate:ee_service_management' client.pk %}" class="px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200">
                        Cancel
                    </a>
                    <button type="submit" class="px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700">
                        Schedule Meeting
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Sidebar -->
    <div class="space-y-6">
        <!-- Tips -->
        <div class="bg-blue-50 border border-blue-200 rounded-xl p-4">
            <h3 class="font-medium text-blue-900 mb-2">Meeting Tips</h3>
            <ul class="text-sm text-blue-800 space-y-2">
                <li class="flex items-start">
                    <svg class="w-4 h-4 text-blue-600 mr-2 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    EE committees should meet quarterly at minimum
                </li>
                <li class="flex items-start">
                    <svg class="w-4 h-4 text-blue-600 mr-2 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    Ensure reasonable notice (7+ days) for members
                </li>
                <li class="flex items-start">
                    <svg class="w-4 h-4 text-blue-600 mr-2 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    Share agenda and supporting docs in advance
                </li>
                <li class="flex items-start">
                    <svg class="w-4 h-4 text-blue-600 mr-2 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    Keep attendance register for compliance
                </li>
            </ul>
        </div>

        <!-- Upcoming Meetings -->
        {% if upcoming_meetings %}
        <div class="bg-white rounded-xl shadow-sm border border-gray-100 p-4">
            <h3 class="font-medium text-gray-900 mb-3">Upcoming Meetings</h3>
            <ul class="space-y-2">
                {% for meeting in upcoming_meetings %}
                <li class="flex items-center justify-between text-sm">
                    <div>
                        <p class="text-gray-900">{{ meeting.title|truncatechars:25 }}</p>
                        <p class="text-xs text-gray-500">{{ meeting.meeting_date|date:"d M Y" }}</p>
                    </div>
                    <span class="px-2 py-0.5 text-xs rounded-full bg-blue-100 text-blue-800">
                        {{ meeting.get_meeting_purpose_display }}
                    </span>
                </li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}
    </div>
</div>

<script>
function loadTemplate(templateId) {
    if (!templateId) return;
    
    // TODO: Implement AJAX template loading
    // For now, templates can be loaded server-side
}
</script>
{% endblock %}
